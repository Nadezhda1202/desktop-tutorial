# Установка Sherpa RPA Coordinator на Windows

Перед установкой Sherpa RPA Coordinator необходимо добавить Робота типа "Координатор" на экране “Роботы” в Оркестраторе. Подробнее о добавление Робота здесь:

{% embed url="https://docs.sherparpa.ru/sherpa-orchestrator/rabota-v-sherpa-orchestrator/nachalo-raboty-v-sherpa-orchestrator/dobavlenie-robota-v-orkestratore" %}

Дистрибутив [SherpaRPACoordinator.exe](https://sherparpa.ru/downloads/SherpaRPACoordinator.exe) устанавливается под учётной записью администратора и впоследствии запускается как сервис от имени System.

Робот в любом из способов установки (с Дизайнером или без) может иметь Роль:

* Attended,&#x20;
* Unattended.&#x20;

Это определяется его Лицензией:

* локальной,
* полученной из Оркестратора.

А также способом запуска (локально или через Оркестратор).

Принцип работы Координатора описан здесь:

{% embed url="https://docs.sherparpa.ru/sherpa-orchestrator/rabota-v-sherpa-orchestrator/nachalo-raboty-v-sherpa-orchestrator/principy-raboty-raznykh-tipov-robotov-v-orkestratore" %}

Установку программы осуществляет инсталлятор, запускаемый файлом  SherpaRPACoordinator.exe. Сохраните данный файл на компьютер и запустите его. В открывшемся окне нажмите кнопку “Дальше”

<figure><img src="../../../.gitbook/assets/изображение (225).png" alt=""><figcaption></figcaption></figure>

Затем заполните следующие поля:

* Оркестратор. Домен сервера / IP;
* Оркестратор. GUID Координатора.

<figure><img src="../../../.gitbook/assets/изображение (226).png" alt=""><figcaption></figcaption></figure>

> GUID Координатора необходимо скопировать из карточки Робота. Для этого, откройте экран Роботы в Оркестраторе.Затем откройте карточку Робота и скопируйте GUID.

Далее необходимо проверить подключение. Для этого нажмите кнопку ![](<../../../.gitbook/assets/изображение (228).png>) в окне установки Координатора.&#x20;

<figure><img src="../../../.gitbook/assets/изображение (227).png" alt=""><figcaption></figcaption></figure>

При необходимости можно воспользоваться дополнительными настройками Координатора (с помощью кнопки ![](<../../../.gitbook/assets/изображение (230).png>)).

<figure><img src="../../../.gitbook/assets/изображение (229).png" alt=""><figcaption></figcaption></figure>

Дополнительная настройка  “Сбрасывать зависшие сессии через:” позволяет настроить частоту сброса зависших RDP-сессий. Данный функционал работает если Робот завершил выполнение Работы, инициировал выход из RDP-сессии и сам закрылся, но операционная система не дала завершить сессию, например,  из-за установки обновлений или из-за другой программы.&#x20;

В этом случае Координатор принудительно завершает процесс RDP-сессии и запускает её заново. Принцип работы данного  функционала заключается в следующем: когда Робот работает – он каждые 15 секунд отправляет в Оркестратор сообщение, когда появляется новая Работа для этого Робота, то в Координатор приходит команда на запуск и время этого последнего сообщения Робота. Если время больше указанного, то Координатор сбрасывает текущую сессию и запускает новую.

А также настроить прокси (с помощью кнопки ![](<../../../.gitbook/assets/изображение (231).png>)).

<figure><img src="../../../.gitbook/assets/изображение (232).png" alt=""><figcaption></figcaption></figure>

При установке можно выбрать один из двух способов создания RDP-подключения:

* FreeRDP - данный способ основан на открытом исходном коде программы "FreeRDP". При работе данного способа задействуются минимальные системные требования для инициализации подключения;
* MS RDP - этот способ использует стандартный способ подключения, встроенный в Windows. Более требовательный к ресурсам, но также более стабильный.

После настройки дополнительных параметров Координатора нажмите кнопку “Дальше”. Начнется процесс установки:

<figure><img src="../../../.gitbook/assets/2 (2).png" alt=""><figcaption></figcaption></figure>

После этого вы увидите окно "Программа успешно установлена на ваш компьютер!".

<figure><img src="../../../.gitbook/assets/изображение (233).png" alt=""><figcaption></figcaption></figure>

После завершения установки Координатора, запускается служба “Sherpa RPA Service”. Чтобы проверить наличие службы “Sherpa RPA Service” необходимо зайти в “Службы” компьютера.&#x20;

<figure><img src="../../../.gitbook/assets/изображение (234).png" alt=""><figcaption></figcaption></figure>

При проверке наличия службы Sherpa RPA Service в реестре служб видно, что она установлена и находится в состоянии “Выполняется”.

В настройках свойств “Sherpa RPA Service” предусмотрена возможность выбрать “Тип запуска” (вкладка Общие). Для удобства тип запуска можно установить “Автоматически (отложенный запуск)”:

<figure><img src="../../../.gitbook/assets/изображение (235).png" alt=""><figcaption></figcaption></figure>

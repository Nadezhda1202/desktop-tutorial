# Принципы Работы разных типов Роботов в Оркестраторе

## **Принцип работы Attended-роботов в Оркестраторе**

**Attended-роботы** — это Роботы, которые запускаются на компьютере Пользователя следующими способами:

* вручную Пользователем;
* из автозагрузки;
* по комбинации клавиш;
* по локальному расписанию.&#x20;

Лицензии “Sherpa Attended Robot” являются именными. Одна лицензия запускается из одной учетной записи Пользователя и лицензируется только на нее.&#x20;

Attended-роботы могут быть добавлены в Оркестратор, но данный тип Роботов не будет запускаться из Оркестратора с помощью создания  Работ на экране “Работы” или расписания на экране “Триггеры”. То есть, сценарии Attended-роботов запускаются только локально.

У Attended-роботов ограниченный список возможностей в Оркестраторе.

Например, Attended-робота целесообразно заводить в Оркестратор, в тех случаях, когда его требуется использовать в режиме станции верификации для  Unattended-робота, работающего на потоковой обработке каких-либо документов или заявок. Unattended-робот при этом обрабатывает все заявки, которые не требуют взаимодействия с человеком, а Attended-робот в режиме станции верификации может использоваться в процессе обработки заявки на каком-либо этапе, когда необходимо подключить человека для принятия определенного решения (то есть верифицировать вручную). Такой Attended-робот (верификатор) обращается к Очереди и берет из нее Задачу, которая была размещена для него Unattended-роботом.

Attended-роботы имеют доступ к Очередям, созданным на экране “Очереди”, также они могут получать Задачи из Очередей, брать эти Задачи в обработку и менять их статус.&#x20;

## **Принцип работы Unattended-роботов в Оркестраторе**

**Unattended-роботы** — это Роботы, которые запускаются без участия человека и управляются только через Оркестратор. Unattended-роботы запускаются:

* по расписанию, созданному на экране “Триггеры”;
* через Очереди Задач, созданные на экране “Очереди”
* через API.&#x20;

Лицензии Sherpa Unattended-Robot являются конкурентными. Одна лицензия позволяет под управлением Оркестратора запустить выполнение сценария на учетной̆ записи любого пользователя (в том числе виртуального, созданного специально для робота). Общее число используемых в один момент времени лицензий не может превышать число зарегистрированных в Оркестраторе лицензий.&#x20;

Unattended-робота можно использовать:

* с ручным запуском сессии пользователя. То есть, если Оркестратор увидит, что Робот находится в сети (зеленый индикатор), то Оркестратор сможет выдавать ему Работу. В этом случае запуск учетной записи Робота должен быть произведен вручную;
* с автоматическим запуском сессии пользователя;
* при классической схеме, когда есть RDP-сервер.&#x20;

## **Принцип работы Координатора Unattended-роботов**

**Координатор** — это сервис, который должен быть установлен под учетной записью Администратора RDP-сервера (терминального сервера), на котором планируется в пользовательских учетных записях запускать Unattended-роботов, при условии, что требуется автоматический вход в учетные записи Роботов. Координатор служит для запуска сессий локальных Пользователей вместе с Unattended-роботами на терминальных серверах под управлением операционных систем Windows.

На сервере есть одна или несколько учетных записей, зарегистрированных за Роботами. Сам по себе сервер работает постоянно, но учетные записи по умолчанию не работают. Соответственно, если на комплектного Робота Оркестратор выделил Задачу, он этого Робота должен включить, а для этого он должен активировать соответствующую учетную запись на сервере. Для этого предназначен специальный компонент – Координатор. Координатор – это отдельная программа, которая не требует лицензии, устанавливается под учетной записью Администратора RDP-сервера и запускается в режиме сервиса.

**Задача координатора:** по команде Оркестратора поднять и удерживать RDP-подключение к локальной или удаленной пользовательской учетной записи, в которой затем запускается Unattended-робот.

Для Attended-роботов указывать Координатора не требуется.

Координатор устанавливается из соответствующего дистрибутива. [Установка Sherpa Coordinator описана здесь. ](../../razvertyvanie-platformy-pod-upravleniem-orkestratora/ustanovka-sherpa-rpa-coordinator/ustanovka-sherpa-rpa-coordinator-na-windows.md)Координатор не требует отдельной лицензии.

Робот с функцией Координатор (для Unattended-роботов) отображается в таблице Роботы. Координатор всегда находится во включенном состоянии, о чем сигнализирует зеленый индикатор. Данный сервис обеспечивает создание и удержание сессий пользовательских учетных записей для Unattended-роботов в рамках используемого терминального сервера.

Все остальные роботы – это технические учетные записи, запущенные на том же терминальном сервере.

Если ваша конфигурация включает терминальный сервер (Windows Server с ролями и лицензиями RDS), обратите внимание, что Координатор необходимо установить с правами администратора. А SherpaRPA Runtime следует настроить в режиме «Unattended» для каждой учетной записи пользователя на этом терминальном сервере, чтобы они функционировали как Unattended-роботы.

В случае если у Вас не предусмотрены терминальные сервера, а есть только группировка виртуальных машин, одну из них нужно выделить под Координатор. Эта виртуальная машина должна быть постоянно включена, т.к. она будет обеспечивать работу Unattended-роботов на других машинах. При этом на самой виртуальной машине согласно стандартной RDP-лицензии Windows вы сможете установить одного Unattended-робота в пользовательской учетной записи.

Оркестратор дает задание Координатору соответствующего терминального сервера создать RDP-подключение к локальной или удаленной учетной записи, выделенной для Unattended-робота:

* по расписанию,
* по вызову API,&#x20;
* по команде Робота,
* по другому поддерживаемому Триггеру.

При этом на одном терминальном сервере может быть размещено и одновременно активно несколько таких учетных записей. Вход в учетную запись Unattended-робота производится с предоставленными Оркестратору логином и паролем.

На стороне Оркестратора этот процесс выглядит следующим образом:

1. После создания Работы Оркестратор определяет, что Unattended-робот недоступен и ему назначен Координатор, который доступен, о чем сигнализирует зеленый индикатор.
2. Оркестратор направляет Координатору команду на включение учетной записи этого Unattended-робота.
3. Координатор принимает команду и в рамках сервера поднимает RDP-подключение своей собственной учетной записи, в которой находится этот Робот. Т.е. он запускает RDP-подключение, учетная запись включается, внутри учетной записи запускается Unattended-робот. В списке Роботов его индикатор становится зеленым.
4. Unattended-робот обращается к Оркестратору, и в случае, если в Работах для него есть Задача, принимает ее и отрабатывает.&#x20;
5. После выполнения Задачи Робот автоматически выйдет из своей учетной записи и учетная запись полностью выключится.&#x20;

<table data-header-hidden><thead><tr><th width="74"></th><th></th></tr></thead><tbody><tr><td><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXfPkmrtL_xzNxzeos1Rj92kStlqg33gZVluXm2e5tIyyc3sovEGBKpOzieCKvjYCvZz-4HUWwlwTgdcIybqzsQbBHduhfLOCFiUmppQ4hUsBEB3ANUcdxRYyj38ThJzSF4dk9king?key=jXxpQJRYkQW6F4d0HoRgIxP1" alt=""></td><td>Если Работа выполняется Роботом из Оркестратора, важно отключить удаленную отладку. В противном случае Робот рискует не выйти из системы.</td></tr></tbody></table>

# Создание и настройка Триггеров в Оркестраторе

Триггеры необходимы для создания работ по заданным условиям автоматически. Созданные работы далее передаются роботам для обработки.

Для создания нового триггера в Оркестраторе перейдите на экран “Триггеры”. Данный экран содержит таблицу “Триггеры”.&#x20;

<figure><img src="../../../.gitbook/assets/изображение (16).png" alt=""><figcaption></figcaption></figure>

Для работы с Триггерами на экране есть следующие кнопки:

| Название             | Описание                                                                                                                                                               |
| -------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Создать              | <p></p><p>Позволяет пользователю создать новый триггер. При нажатии открывается форма для ввода необходимых данных и настройки параметров нового триггера.</p>         |
| Обновить             | Позволяет обновить информацию о выбранном триггере.                                                                                                                    |
| Удалить выбранное    | Позволяет удалить один или несколько выбранных триггеров.                                                                                                              |
| Включить выбранное   | Активирует выбранные триггеры, позволяя им начать работу в системе.                                                                                                    |
| Выключить выбранное  | Деактивирует выбранные триггеры, останавливая их выполнение и отключая их функции.                                                                                     |
| Протестировать       | Позволяет протестировать выбранный триггер. Это помогает убедиться в том, что триггер работает корректно и выполняет запланированные действия.                         |
| Импорт из CSV        | Позволяет пользователю загружать данные о триггерах из файла формата CSV. При выборе этой опции открывается диалоговое окно для загрузки файла с необходимыми данными. |
| Экспорт в CSV        | Позволяет сохранить информацию о триггерах в формате CSV.                                                                                                              |
| Экспорт в XLSX       | Позволяет экспортировать данные о триггерах в формате XLSX.                                                                                                            |

Чтобы создать новый триггера нажмите на кнопку “Создать” в таблице “Триггеры” и заполните открывшуюся форму. Для удобства, настройка триггеров разделена на несколько вкладок:

* “Основные”. Основные данные триггера;
* “Роботы”. Выбор робота или группы роботов для работы, которым будет передана работа после срабатывания триггера;
* “Расписание”. Расписание, по которому будет срабатывать триггер. Доступны следующие варианты расписания: “Обрабатывать непрерывно”, “Обрабатывать по расписанию”, “Последний день месяца”, “N-ный день месяца”;
* “Очередь”. Настройка создания работ при появлении новых задач в очереди;
* “Email”. Настройка триггера с определенными условиями при необходимости создания работ, связанных с обработкой электронной почты.

Рассмотрим подробнее каждую из вкладок.

Во вкладке “Основные” заполните следующие поля:

* поле “Имя”. Обязательное для заполнения поле.
* поле “Описание”. Описание триггера при необходимости.
* поле "Папка доступа". Выберите из выпадающего списка папку доступа;
* поле “Процесс”. Выберите из выпадающего списка процесс, который будет запускаться при срабатывании триггера (процесс можно выбрать только из числа ранее созданных на экране “Процессы”). Обязательное для заполнения поле.
* поле “Макс. количество запусков”. Укажите максимальное количество запусков триггера. Если ограничений нет, в данном поле необходимо поставить 0.
* переключатель “Включено”. Активируйте переключатель, если необходимо, чтобы триггер был включен непосредственно после его создания.
* флаг “Если все роботы заняты, создавать работу после их освобождения”.

<figure><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXdzyI2sD0wZSLyb9pAfsVUKZ7oVp3MT_TlCQQhwnqLBSxXcH9mqNelNcpg7_LmjOkFsf92k0nQz_PcqH_d2yEX9hRTOKWDUT140xMvqxD_fSZwmtH14TMU31h_HywY_ZBpkhL3DPATxUFdvvHSpCZsFi20t?key=x3cwxCWzWUlDYD7sNlnCJQ" alt=""><figcaption></figcaption></figure>

Во вкладке “Роботы” укажите следующие данные:

* установите флаг “Передавать работу определенному роботу”, если необходимо, чтобы работу выполнял конкретный робот. В поле “Робот”, расположенном ниже, выберите из выпадающего списка нужного робота.
* установите флаг “Распределить работу по группе роботов”, если необходимо передать работу определенной группе роботов. В поле “Группа роботов”, расположенном ниже, выберите из выпадающего списка нужную группу роботов.
* в поле “Максимальное количество одновременно запущенных роботов” укажите максимальное количество одновременно запущенных роботов, которые будут выполнять работы, созданные данным триггером.&#x20;

Если в указанной группе все роботы заняты:

* флаг "Создать работу без заранее присвоенного робота. Как только какой-либо робот в группе освободится, работа будет автоматически присвоена ему".
* флаг "Создать работу для еще занятого робота группы, у которого наименьшее число работ находится в статусе Pending".

<figure><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXcD1PEiZ4MKBV9o1FjDFAuEz6Egj3lsd_5Ddl5tqPcpgXt17D6l9FZidzPuQQ9--RF8wdDRWfodbrTZ4lFxYww2mv_7bA8xFyYM7BOQ-7Mr30WoaLD8_xZ5GYiTAuCaVKqfg-fPQx1PDO6AUBDUU5BWOpEs?key=x3cwxCWzWUlDYD7sNlnCJQ" alt=""><figcaption></figcaption></figure>

Вкладка “Расписание” выглядит по-разному, в зависимости от того, какой вариант расписания Вы выберете.&#x20;

Выберите вариант “Обрабатывать непрерывно”, если необходимо, чтобы работы проводились непрерывно, с учетом ограничений, заданных на других вкладках. В форме укажите следующие данные:

* в поле  “Кроме нерабочих дней согласно календарю:” с помощью выпадающего списка выберите нужный календарь из числа ранее созданных на экране “Ресурсы”.
* в поле “Остановить работу через указанный промежуток времени после ее создания” укажите предельную длительность работы в формате часы:минуты до “мягкой” остановки.
* в поле “Прервать работу через указанный промежуток времени после ее создания” укажите предельную длительность работы в формате часы:минуты до “жесткой” остановки.
* в полях  “Расписание действует с” и “Расписание действует до” укажите дату и время в формате ДД.ММ.ГГГГ часы:минуты:секунды с которого и до которого, соответственно, будет действовать расписание.&#x20;

<figure><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXc8OOcXJ_GgaUCFn59gJUCAIuWrxmKAxrGanMYSjTjr2DQU1Kzq_6X7Jia9BTTfiMAdbZvQ9N2W-Z0cSw-fjVdQLcK19jjZyroZbc8TfOA9Km5n_qp3_u6Ep4O2iXe6aRsLrTQl79BOvTdJ7EZqj6_Bk-My?key=x3cwxCWzWUlDYD7sNlnCJQ" alt=""><figcaption></figcaption></figure>

Выберите вариант “Обрабатывать по расписанию”, если необходимо, чтобы работы проводились по установленному расписанию. Данная форма практически идентична варианту “Обрабатывать непрерывно”, за исключением следующих элементов:&#x20;

* активируйте переключатель “Использовать выражение Cron”, если необходимо определить расписание для срабатывания триггера напрямую.
* Используйте данный элемент интерфейса![](https://lh7-rt.googleusercontent.com/docsz/AD_4nXe58P6X-fagbodLjpHW1hpdDlwRyxBIYv7FUZUAKiOBoLEr6QHslxxkedfYjsKYsL4hzxhTufrsE-7Xbmhuj9zt61PBewkyFmU4iVxy0w2STYu0ksKVZMajg5TEYlT_IZoz_p7ADus6OE_K8xQpe1a4hDg?key=iLsscOkAYkVnzVdVDr-zyA)для установки расписания триггера.

<figure><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXc9wQKA61xQc6sOip219ycgy5WIkCdSmqKMuNy3osl76gQNFmAFfxjQ0qkZ6vJlX0M66s329XuarbIcU2u99XfY24Bl_czLbUv5xHR7gGEjdtusWw73w95JdRe5hO9ZoNPRj_9x0MI6aZ4Vzhw7awZaw4w_?key=x3cwxCWzWUlDYD7sNlnCJQ" alt=""><figcaption></figcaption></figure>

Выберите вариант “Последний день месяца”, если необходимо, чтобы работы проводились в последний день месяца. Данная форма практически идентична варианту “Обрабатывать непрерывно”, за исключением элемент интерфейса![](https://lh7-rt.googleusercontent.com/docsz/AD_4nXe58P6X-fagbodLjpHW1hpdDlwRyxBIYv7FUZUAKiOBoLEr6QHslxxkedfYjsKYsL4hzxhTufrsE-7Xbmhuj9zt61PBewkyFmU4iVxy0w2STYu0ksKVZMajg5TEYlT_IZoz_p7ADus6OE_K8xQpe1a4hDg?key=iLsscOkAYkVnzVdVDr-zyA), который необходимо использовать для установки расписания триггера.

<figure><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXfdDDIA2zE0G6zZrErlPu6sqJaqRTfi1as7tI7QynUI5V2l0k7KxlQMC7p2ZKxchlw75IqPChD7P_vaoyjix1TnDs81a5xC3ri0P-OJ72Jo7LEUpahBCOWjcF8vRN-2OJGKTq_ouy4A4NtjKvNiMNc7UlE?key=x3cwxCWzWUlDYD7sNlnCJQ" alt=""><figcaption></figcaption></figure>

Выберите вариант “N-ный день месяца”, если необходимо, чтобы работы проводились каждый N-ный день месяца. Данная форма практически идентична варианту “Последний день месяца”, за исключением поля “N-ный день”.

<figure><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXe8OKS1f6VWFJuI5lS_WmAnuJCfSwD3cNmsuULCmRwbgcAqliHmB1kZVT3PbBtzAMbT2oBVAaNCNtwei-NbaJb8diQN_2H9YC3T79JIjmhcL9XmFbpUUzjNTkzCUl3yb1yo5PkP_4J4MC-YC5kHa1iPhrw2?key=x3cwxCWzWUlDYD7sNlnCJQ" alt=""><figcaption></figcaption></figure>

Во вкладке “Очередь” укажите следующие данные:

* установите флаг  “Создавать работы при появлении новых задач в очереди”, чтобы  включить функцию создания работ при появлении новых задач в очереди.
* в поле “Очередь” с помощью выпадающего списка выберите определенную очередь из числа ранее созданных на экране “Очереди”.
* в поле "Учитывать только задачи, которые помечены всеми перечисленными тегами одновременно" укажите теги, которыми должны быть помечены задачи.
* в поле “Запустить когда новых задач больше чем” укажите количество новых задач в очереди, после которого будет запускаться робот.
* в поле “Установить статус полученной из очереди задачи” с помощью выпадающего списка укажите статус задачи, выбрав его из предложенных вариантов “Создано” или “В процессе”.
* установите флаг “Завершить при пустой очереди”, если необходимо завершить триггер при отсутствии задач в очереди. В этом случае у триггера будет установлен статус “Завершено”.
* установите флаг “Назначить задачу по умолчанию создаваемым работам”, если необходимо привязать триггер к к определенной задаче и использовать эту задачу  в качестве задачи по умолчанию при создании работ триггером.
* в поле “Задача” с помощью выпадающего списка выберите определенную задачу из числа ранее созданных на экране “Очереди”.

<figure><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXdUxwnIQNJN82Lhg22o4aVdUSzCr6KuluRf1q4b_V84S3mn1nPr3XVJ4SOqb3K3TVUK7baPUTxnezE_CRXi799dLo3yJre4pcXtafmgwJ6fxbWi_QuqT3EVnE-1OLCKrVm8Ozg_IaU8YmPzOskyRpttYiT3?key=x3cwxCWzWUlDYD7sNlnCJQ" alt=""><figcaption></figcaption></figure>

Во вкладке “Email” укажите следующие данные:

* установите флаг “Создать работу по поступлению Email”, чтобы создавать работу при поступлении письма на электронную почту.
* выберите протокол получения электронной почты из предложенных вариантов “POP3” и “IMAP”.
* выберите вариант кодировки из предложенных вариантов “UTF-8” и “US-ASCII”.
* в полях “Почтовый сервер” и “Порт” укажите почтовый сервер и его порт соответственно.&#x20;
* в полях “Логин” и “Пароль” укажите логин и пароль доступа к почтовому сервису.
* в поле “Название общего почтового ящика” укажите название общего почтового ящика, его следует указывать только в случаях, когда несколько пользователей имеют доступ к одному почтовому ящику.
* в поле “Папка” укажите папку в почтовой ящике. Если папка не задана, то по умолчанию будет проверяться папка “Входящие”.
* установите флаг “Использовать SSL”, если необходимо использовать SSL при подключении к почтовому серверу.
* установите флаг “Обрабатывать только непрочитанные письма”, если необходимо обрабатывать только непрочитанные письма.
* установите флаг “Пометить как прочитанное”, чтобы отмечать как “Прочитанное” письма, по которым были созданы работы.
* установите флаг “Создать одну работу по факту появления любого количества новых писем / Создать работу для каждого нового письма”, если необходимо создавать одну работу по факту появления любого количества новых писем или по отдельной работе для каждого нового письма.
* в поле “Обрабатывать, если тема письма содержит любую из указанных подстрок” укажите подстроки, которые должны содержаться в теме письма (при указании нескольких подстрок необходимо разделять их запятыми), если это необходимо.
* в поле “Обрабатывать, если тело письма содержит любую из указанных подстрок” укажите подстроки, которые должны содержаться в теле письма (при указании нескольких подстрок необходимо разделять их запятыми), если это необходимо.
* в поле “Обрабатывать, если письмо содержит вложения с любым из указанных имен файлов” укажите имена файлов, которые должны содержаться во вложениях письма (при указании нескольких имен файлов необходимо разделять их запятыми, при необходимости можно использовать маски \* и ?), если это необходимо.
* в поле “Обрабатывать когда подходящих писем больше чем” укажите количество писем, после которого будет запускать обработка (проверка условий триггера и создание работ, если необходимо).
* в поле “Проверять почту каждые N минут” укажите временной интервал в минутах, через который будет осуществляться проверка почты на сервере и создание работ, если необходимо (если выполнены указанные выше условия триггера).

<figure><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXdsxpMjBvCJruXQ58q1yuxkimFXUSRFVuXESMX7zGmfMed-r6FeTGYlDOgNAKnFvL95Y7SRxksA7buRKcSI7xPWpdOSobwg01u79nfTQqykFesH8ZstmgXL3U1APSaApq8gXwNRLB7gVyv-ugF2UIVK9_Hg?key=x3cwxCWzWUlDYD7sNlnCJQ" alt=""><figcaption></figcaption></figure>

После заполнения полей нажмите кнопку “ОК”, чтобы сохранить триггер.

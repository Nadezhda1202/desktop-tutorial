# Версия 1.33

**Вышел новый релиз Sherpa Designer: версия 1.33.**

1\) Выпущен Sherpa RPA Designer для OC Linux. Скачать можно [здесь](../../ssylki-na-distributivy/distributivy-sherpa-rpa-linux.md).

2\) В палитру блоков «Машинное обучение» добавлена поддержка новых нейросетей и обновлены существующие.&#x20;

Добавлены следующие блоки:&#x20;

* Запрос к YandexGPT;
* Запрос к GigaChat;
* Генерировать изображение Sber GigaChat;
* Запрос к Claude;
* Запрос к GroqChat.

Также добавлены модели блока «Запрос к ChatGPT»: «gpt-4o» и «gpt-4o-mini».

3\) Для работы с Sherpa AI Server добавлены и обновлены следующие блоки:&#x20;

* AI Server. Добавить файл;
* AI Server. Добавить чанки;
* AI Server. Найти эмбеддинги;
* AI Server. Удалить папку/файл.

4\) В блок запуска кода Java добавлен функционал поддержки работы со сторонними библиотеками.

5\) В блок запуска кода JavaScript добавлен функционал работы в браузере с поддержкой передачи переменных скрипта из кода и в него.

6\) Добавлен блок «Получить селекторы», который позволяет получить список селекторов для одноуровневых элементов, а также для дочерних элементов. Этот блок позволяет организовать обход интерфейсов со сложной иерархией и с заранее неизвестным числом элементов, со вложенными элементами, сложных таблиц и т.д. Полученные селекторы можно использовать в любом другом блоке для работы с интерфейсами, поддерживающем вставку селекторов из переменных.

7\) Добавлен новый механизм поиска селекторов: «Одноуровневый поиск». Он полезен для поиска скрытых (не отображающихся пользователю) элементов пользовательских интерфейсов. По умолчанию скрытые элементы не обрабатываются платформой, однако данных механизм позволяет работать с ними. Для включения одноуровневого поиска необходимо зайти в настройки Ассистента и во вкладке «Селекторы» установить флаг «Для поиска селекторов включить одноуровневый поиск». Также данный функционал можно включить с помощью блока «Параметры селекторов».

8\) В селекторы добавлен режим перебора элементов пользовательских интерфейсов с помощью “курсора”. С помощью блока «Установить курсор» можно установить виртуальный курсор (выбор элемента) на каком-либо элементе в программе (кнопка, элемент списка, ячейка таблицы и т.д.).&#x20;

Далее этим же блоком можно перемещать курсор на соседние или дочерние элементы, то есть как горизонтально так и вертикально по иерархии элементов, и таким образом организовывать обход пользовательских элементов по нужной схеме или добраться до элемента с динамическим (меняющимся) селектором. В окно редактора блока добавлена кнопка «Включить режим курсора». При включении режима курсора блок будет использовать не селектор, указывающий на элемент, а курсор, который стоит на каком-либо элементе в какой-либо программе.

Рассмотрим следующий пример:

**Задача:** получить текст из поля редактирования, но у данного поля нет точного селектора.

**Решение:** в данном случае можно установить курсор на текстовом поле, а затем переместиться на нужный элемент и получить из него текст.

Используя блок «Установить курсор», устанавливаем его на поле «Пароль», после чего в этом блоке необходимо прописать команды движения курсора: «Return,Next,Enter». Далее необходимо установить блок «Получить текст» и включить режим курсора в селекторе этого блока, после чего можно извлечь текст.

9\) Добавлен модификатор привязки селектора для поиска (модификатор якоря). \
Для использования модификатора в поле селектора «ParentIndent» необходимо перед числом прописать префикс «bind:», который будет указывать, что поиск следующей строки селектора будет производиться начиная с текущей позиции элемента.&#x20;

В случае, если модификатор «bind» в этом селекторе не будет использован, то будет найдено текстовое поле «Логин».

10\) Во все блоки, в которых есть функция создания скриншота, добавлено выходное свойство, которое возвращает полный путь до файла с получившимся скриншотом.

11\) В блок «Try\Catch» добавлено свойство «Пауза между попытками» (количество секунд задержки между попытками). Также, в зависимости от уровня сообщения,  производится логирование каждой попытки.

12\) В блок «Распознать по шаблону» добавлена возможность указать список файлов изображений. Также можно указать номера и диапазоны страниц, которые будут участвовать в распознавании. Например: «1, 3, 47-50»

13\) В блок «Скролл мышкой» добавлена возможность горизонтального скроллинга.

14\) Добавлен новый блок «Получить данные с DataGrid», который предназначен для получения таблицы из табличного компонента приложения. Данный блок делает проверку на поддержку выбранным с помощью селектора компонентом паттерна GridPatternId, после чего:

* если данный паттерн поддерживается, то извлечение таблицы происходит с помощью него;
* если данный паттерн не поддерживается, то блок извлекает таблицу напрямую, исходя из указанного селектора.

В структуре селектора предусмотрено, что последняя строка ControlType является указателем на ячейки таблицы, предпоследняя строка ControlType – указателем на строки. Блок «Получить данные с DataGrid» позволяет извлекать данные из табличного компонента приложения и сразу сохранять их в CSV-файл.

15\) Добавлена возможность указывать селектор в виде переменной.&#x20;

Для этого необходимо создать текстовую переменную и вставить в нее текст селектора, после чего в окне редактирования селектора, нажать кнопку «Включить режим переменной», которая находится в нижней части окна редактора селектора, затем в поле «Value» вставить переменную с селектором.

16\) В Ассистент и в Робот добавлен VNC-сервер.&#x20;

Данная функция позволяет, например, при запуске Unattended-робота подключиться к машине с помощью VNC-клиента для наблюдения за действиями робота. Настройка пароля и порта выполняется в настройках Ассистента, во вкладке «Выполнение/VNC-сервер».

17\) Добавлена возможность единовременно отобразить все комментарии на диаграмме.&#x20;

Для этого необходимо в нижней части интерфейса Дизайнера нажать на знак желтого флажка над панелью «Лог».

18\) Для плавающих лицензий Sherpa Attended Floating в Оркестраторе добавлены следующие функции:

* Запретить запуск локальных роботов в Sherpa Assistant;
* Запретить исполнение кода C#, VB, Python, Java и PowerShell в сценариях;
* Принудительно логировать все блоки.

Данные функции позволяют ограничивать возможности пользователей по запуску произвольных роботов и обеспечивают соблюдение типовых требований информационной безопасности.

19\) В Ассистент, на вкладке «Оркестратор», добавлена функция «Перезагрузить при неудачном завершении работы».&#x20;

В случае, если Unattended-робот завершает работу в статусе «Failed», то он перезагрузит компьютер (при наличии прав на это).

20\) При запуске Unattended-робот записывает в лог название процесса и версию процесса, которую он выполняет.

Скачать новую версию Sherpa RPA Designer можно [здесь](../../ssylki-na-distributivy/distributivy-sherpa-rpa-windows.md), ее необходимо установите поверх старой версии (старую версию удалять не нужно).

# 1С

### Подключиться

Создать подключение к серверу 1С или запустить толстый клиент.

<table data-header-hidden><thead><tr><th width="203"></th><th></th></tr></thead><tbody><tr><td>Тип подключения</td><td>Выбор типа подключения. Возможные варианты: Server - подключение к серверу без запуска приложения, Application - запуск толстого клиента, ApplicationHidden - запуск толстого клиента, окно которого будет скрыто. Для работы в режиме Server необходимо зарегистрировать объект V83.COMConnector (для этого выполняется команда "regsvr32 comcntr.dll"). Для работы в режиме Application и ApplicationHidden  необходимо зарегистрировать объект "V83.Application (для этого выполняется команда "1cv8.exe /regserver")</td></tr><tr><td>Строка подключения</td><td>[Текст] Строка подключения к 1С. Для файловой базы данных используется строка "File=""C:\1cPath"";", для серверной - "Srvr=""TestServer"";Ref=""TestBase"";"</td></tr><tr><td>Пользователь</td><td>[Текст] Имя пользователя для авторизации</td></tr><tr><td>Пароль</td><td>[Текст/SecureString] Пароль для авторизации</td></tr><tr><td>Версия 1С</td><td>Версия 1С</td></tr><tr><td>Соединение</td><td>[Ссылка] Возвращается объект подключения к 1С</td></tr><tr><td>Уровень обработки</td><td>Выбор уровня обработки ошибок. Возможные значения: "Default" - по умолчанию; "Ignore" - ошибки игнорируются; "Handle" - ошибки обрабатываются. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Уровень сообщений</td><td>Выбор уровня сообщений, которые будут выводить блоки при работе. Возможные значения: "Default" - по умолчанию; "Release" - вывод отключен; "Debug" - вывод основной информации; "Detailed" - вывод подробной информации. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Текст ошибки</td><td>[Текст] Возвращает подробную информацию об ошибке в случае некорректного выполнения работы блока</td></tr></tbody></table>

### Закрыть соединение

Закрыть соединение с сервером 1С.

<table data-header-hidden><thead><tr><th width="209"></th><th></th></tr></thead><tbody><tr><td>Соединение</td><td>[Ссылка] Объект подключения к 1С. Название переменной в данном свойстве должно совпадать с названием переменной в свойстве "Соединение", блока "Подключиться" из группы 1С, который ранее использовался для подключения к 1С</td></tr><tr><td>Уровень обработки</td><td>Выбор уровня обработки ошибок. Возможные значения: "Default" - по умолчанию; "Ignore" - ошибки игнорируются; "Handle" - ошибки обрабатываются. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Уровень сообщений</td><td>Выбор уровня сообщений, которые будут выводить блоки при работе. Возможные значения: "Default" - по умолчанию; "Release" - вывод отключен; "Debug" - вывод основной информации; "Detailed" - вывод подробной информации. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Текст ошибки</td><td>[Текст] Возвращает подробную информацию об ошибке в случае некорректного выполнения работы блока</td></tr></tbody></table>

### Выполнить запрос

Выполнить запрос к 1С и получить таблицу данных с результатом.

<table data-header-hidden><thead><tr><th width="201"></th><th></th></tr></thead><tbody><tr><td>Соединение</td><td>[Ссылка] Объект подключения к 1С. Подключение должно быть выполнено с типом "Server". Название переменной в данном свойстве должно совпадать с названием переменной в свойстве "Соединение", блока "Подключиться" из группы 1С, который ранее использовался для подключения к 1С</td></tr><tr><td>Запрос</td><td>[Текст] Запрос, который будет выполнен в 1С. Например: "ВЫБРАТЬ Наименование ИЗ Справочник.Пользователи"</td></tr><tr><td>Результат</td><td>[Таблица Данных] Таблица, содержащая полученный результат</td></tr><tr><td>Уровень обработки</td><td>Выбор уровня обработки ошибок. Возможные значения: "Default" - по умолчанию; "Ignore" - ошибки игнорируются; "Handle" - ошибки обрабатываются. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Уровень сообщений</td><td>Выбор уровня сообщений, которые будут выводить блоки при работе. Возможные значения: "Default" - по умолчанию; "Release" - вывод отключен; "Debug" - вывод основной информации; "Detailed" - вывод подробной информации. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Текст ошибки</td><td>[Текст] Возвращает подробную информацию об ошибке в случае некорректного выполнения работы блока</td></tr></tbody></table>

### Выполнить код

Запустить на исполнение код на сервере или клиенте, Для работы данного блока необходимо, чтобы у пользователя была отключена опция "Защита от опасных действий", а также включена роль "Интерактивное открытие внешних отчетов и обработок". Для работы со справочниками тип подключения должен быть "Server".

<table data-header-hidden><thead><tr><th width="196"></th><th></th></tr></thead><tbody><tr><td>Соединение</td><td>[Ссылка] Объект подключения к 1С. Название переменной в данном свойстве должно совпадать с названием переменной в свойстве "Соединение", блока "Подключиться" из группы 1С, который ранее использовался для подключения к 1С</td></tr><tr><td>Код</td><td>[Текст] Строка кода на языке 1С, которую необходимо выполнить. Например: "Номенклатура = Справочники.Номенклатура.СоздатьЭлемент(); Номенклатура.Наименование = ""Тестовая Номенклатура""; Номенклатура.Записать();"</td></tr><tr><td>Результат</td><td>[Текст] Результат выполнения кода. Для возврата значений необходимо использовать временное хранилище. Вы должны в коде использовать такие строки: "SherpaВозврат = ПоместитьВоВременноеХранилище(ОтправляюСообщение, УникИдент);". УникИдент - может быть любым генерируемым. SherpaВозврат - эта переменная используется для извлечения значения после выполнения кода и имя не должно изменяться</td></tr><tr><td>Уровень обработки</td><td>Выбор уровня обработки ошибок. Возможные значения: "Default" - по умолчанию; "Ignore" - ошибки игнорируются; "Handle" - ошибки обрабатываются. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Уровень сообщений</td><td>Выбор уровня сообщений, которые будут выводить блоки при работе. Возможные значения: "Default" - по умолчанию; "Release" - вывод отключен; "Debug" - вывод основной информации; "Detailed" - вывод подробной информации. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Текст ошибки</td><td>[Текст] Возвращает подробную информацию об ошибке в случае некорректного выполнения работы блока</td></tr></tbody></table>

### Извлечь данные

Блок позволяет извлечь данные из табличных форм 1С.

<table data-header-hidden><thead><tr><th width="202"></th><th></th></tr></thead><tbody><tr><td>Селектор</td><td>[Селектор] Интерактивный выбор набора однотипных элементов пользовательского интерфейса</td></tr><tr><td>Количество строк</td><td>Максимальное количество извлекаемых строк</td></tr><tr><td>Колонки</td><td>[Список] Список имен колонок таблицы. Если значение не указать, то колонки будут определяться автоматически.</td></tr><tr><td>Таблица по колонкам</td><td>При включении таблица будет строиться по указанным в свойстве "Колонки" названиям колонок. Иначе таблица строится по координатам ячеек</td></tr><tr><td>Текущая страница</td><td>Если включено, то робот не будет пролистывать таблицу, а извлечет только текущие "видимые" данные</td></tr><tr><td>ID процесса</td><td>[Ссылка] Переменная, в которой хранится идентификатор процесса. Указывает, с каким приложением необходимо работать. Если указанное приложение свернуто или его окно закрыто другими окнами, то оно будет выведено на передний план. При работе с браузерами ID процесса дополнительно указывает на конкретную вкладку браузера, с которой должен работать блок. Если свойство оставить пустым, либо если переменная ID процесса не была ранее присвоена в момент запуска приложения или открытия браузера, приложение и вкладка браузера будут определены из содержимого соответствующей строки селектора. ID процесса может быть получен, например, с помощью блоков Запустить приложение или Получить процесс.</td></tr><tr><td>Задержка перед</td><td>[Число] Задержка в секундах перед выполнением блока</td></tr><tr><td>Задержка после</td><td>[Число] Задержка в секундах после выполения блока</td></tr><tr><td>Время ожидания</td><td>[Число] Предельное время ожидания появления элемента в секундах</td></tr><tr><td>Результат</td><td>[Таблица Данных] Таблица, содержащая извлеченные данные</td></tr><tr><td>Уровень обработки</td><td>Выбор уровня обработки ошибок. Возможные значения: "Default" - по умолчанию; "Ignore" - ошибки игнорируются; "Handle" - ошибки обрабатываются. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Уровень сообщений</td><td>Выбор уровня сообщений, которые будут выводить блоки при работе. Возможные значения: "Default" - по умолчанию; "Release" - вывод отключен; "Debug" - вывод основной информации; "Detailed" - вывод подробной информации. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Текст ошибки</td><td>[Текст] Возвращает подробную информацию об ошибке в случае некорректного выполнения работы блока</td></tr></tbody></table>

### Клик мышкой по ячейке в таблице 1С

Клик мышкой по ячейке в таблице 1С.

<table data-header-hidden><thead><tr><th width="197"></th><th></th></tr></thead><tbody><tr><td>Селектор</td><td>[Селектор] Идентификатор элемента пользовательского интерфейса</td></tr><tr><td>Действие</td><td>Выбор действия: левый клик, двойной клик, правый клик, навести курсор</td></tr><tr><td>Строка</td><td>[Число] Номер строки в таблице. Нумерация начинается с 0</td></tr><tr><td>Колонка</td><td>[Число] Номер колонки в таблице. Нумерация начинается с 0</td></tr><tr><td>ThumbImage</td><td>Thumb Image</td></tr><tr><td>ID процесса</td><td>[Ссылка] Переменная, в которой хранится идентификатор процесса. Указывает, с каким приложением необходимо работать. Если указанное приложение свернуто или его окно закрыто другими окнами, то оно будет выведено на передний план. При работе с браузерами ID процесса дополнительно указывает на конкретную вкладку браузера, с которой должен работать блок. Если свойство оставить пустым, либо если переменная ID процесса не была ранее присвоена в момент запуска приложения или открытия браузера, приложение и вкладка браузера будут определены из содержимого соответствующей строки селектора. ID процесса может быть получен, например, с помощью блоков Запустить приложение или Получить процесс.</td></tr><tr><td>Задержка перед</td><td>[Число] Задержка в секундах перед выполением блока</td></tr><tr><td>Задержка после</td><td>[Число] Задержка в секундах после выполения блока</td></tr><tr><td>Время ожидания</td><td>[Число] Предельное время ожидания заданного элемента в секундах</td></tr><tr><td>Смещение по X</td><td>[Число] Относительное смещение клика по координате X от левого верхнего угла элемента</td></tr><tr><td>Смещение по Y</td><td>[Число] Относительное смещение клика по координате Y от левого верхнего угла элемента</td></tr><tr><td>Быстрый метод</td><td>Использовать быстрый метод для обнаружения ячейки. Можно использовать если поиск ячеек используется в первой строке</td></tr><tr><td>Уровень обработки</td><td>Выбор уровня обработки ошибок. Возможные значения: "Default" - по умолчанию; "Ignore" - ошибки игнорируются; "Handle" - ошибки обрабатываются. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Уровень сообщений</td><td>Выбор уровня сообщений, которые будут выводить блоки при работе. Возможные значения: "Default" - по умолчанию; "Release" - вывод отключен; "Debug" - вывод основной информации; "Detailed" - вывод подробной информации. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Текст ошибки</td><td>[Текст] Возвращает подробную информацию об ошибке в случае некорректного выполнения работы блока</td></tr></tbody></table>

### Управление CheckBox

Блок управляет элементом CheckBox. Позволяет включать его, выключать, переключать и получать текущее состояние

| Селектор          | \[Селектор] Идентификатор элемента пользовательского интерфейса                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| ----------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Действие          | Выбор действия. Возможные значения: Check - включить; Uncheck - выключить; Switch - переключить; Verify - проверить и вернуть значение                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| ID процесса       | \[Ссылка] Переменная, в которой хранится идентификатор процесса. Указывает, с каким приложением необходимо работать. Если указанное приложение свернуто или его окно закрыто другими окнами, то оно будет выведено на передний план. При работе с браузерами ID процесса дополнительно указывает на конкретную вкладку браузера, с которой должен работать блок. Если свойство оставить пустым, либо если переменная ID процесса не была ранее присвоена в момент запуска приложения или открытия браузера, приложение и вкладка браузера будут определены из содержимого соответствующей строки селектора. ID процесса может быть получен, например, с помощью блоков Запустить приложение или Получить процесс. |
| Задержка перед    | \[Число] Задержка в секундах перед выполением блока                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| Задержка после    | \[Число] Задержка в секундах после выполения блока                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| Время ожидания    | \[Число] Предельное время ожидания заданного элемента в секундах                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| Результат         | \[Логический] Возвращает значение bool, которое показывает текущее состояние элемента или его новое состояние если было произведено переключение                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| ThumbImage        | Thumb Image                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| Уровень обработки | Выбор уровня обработки ошибок. Возможные значения: "Default" - по умолчанию; "Ignore" - ошибки игнорируются; "Handle" - ошибки обрабатываются. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| Уровень сообщений | Выбор уровня сообщений, которые будут выводить блоки при работе. Возможные значения: "Default" - по умолчанию; "Release" - вывод отключен; "Debug" - вывод основной информации; "Detailed" - вывод подробной информации. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы                                                                                                                                                                                                                                                                                                                                                                                         |
| Текст ошибки      | \[Текст] Возвращает подробную информацию об ошибке в случае некорректного выполнения работы блока                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |

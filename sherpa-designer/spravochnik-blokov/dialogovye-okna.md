# Диалоговые окна

### Показать окно

Блок позволяет создавать свои собственные окна (формы) и отображать их в модальном и немодальном режиме, в том числе асинхронно по отношению к ходу сценария. Если задан селектор, координаты созданного окна будут привязаны элементу управления в другом приложении.  Для создания и редактирования своего окна воспользуйтесь кнопкой «Редактировать...» блока, а для создания переиспользуемых окон - кнопкой «Редактор окон» на главной панели инструментов. Каждый вызов данного блока показывает либо обновляет данные окна (если окно уже на экране). В случае если окно немодальное, повторный вызов блока «Показать окно» позволяет динамически обновлять элементы управления в окне и переменные, которые привязаны к элементам окна.   Значения каждого из элементов управления, а также действия пользователей в окне могут быть привязаны к изменению значений выбранных переменных, и наоборот - изменение значений переменных приводит к изменению значений соответствующих элементов управления. Этот функционал позволяет разрабатывать в рамках сценария робота разветвленные диалоговые и экспертные системы, окна настроек робота, интерактивные подсказки и помощников, а также целые многооконные приложения.

<table data-header-hidden><thead><tr><th width="174"></th><th></th></tr></thead><tbody><tr><td>Конфигурация</td><td>[Текст/Объект] Строка  конфигурации. Для редактирования значения необходимо использовать кнопку на блоке "Редактировать".</td></tr><tr><td>Объект окна</td><td>[Объект] Переменная с объектом окна. Объект окна можно получить из предыдующего блока "Показать окно" в сценарии и это актуально для отображения окна в не модальном режиме</td></tr><tr><td>Модальное</td><td>При включении окно будет показано как модальное. Иначе после отображения окна управление сразу перейдет в скрипт</td></tr><tr><td>Селектор</td><td>[Селектор] Идентификатор элемента, к которому будет привязано окно при его отображении. Если селектор не задан, то свойство игнорируется. Если элемент будет найден, то окно будет отображаться в зависимости от заданных настроек в свойствах этого блока. Если селектор не будет найден, то окно будет отображаться посередине экрана.</td></tr><tr><td>ID процесса</td><td>[Ссылка] Переменная, в которой хранится идентификатор процесса. Указывает, с каким приложением необходимо работать. Если указанное приложение свернуто или его окно закрыто другими окнами, то оно будет выведено на передний план. При работе с браузерами ID процесса дополнительно указывает на конкретную вкладку браузера, с которой должен работать блок. Если свойство оставить пустым, либо если переменная ID процесса не была ранее присвоена в момент запуска приложения или открытия браузера, приложение и вкладка браузера будут определены из содержимого соответствующей строки селектора. ID процесса может быть получен, например, с помощью блоков Запустить приложение или Получить процесс.</td></tr><tr><td>ThumbImage</td><td>Thumb Image</td></tr><tr><td>Угол привязки</td><td>Выбор значения угла привязки окна. Если селектор задан, то значение указывает привязку левого верхнего угла окна к углу найденного элемента (при этом значение "Default" будет указывать на центр элемента). Если селектор задан, но не был найден, то при любом значении свойства окно отобразится посередине окна. Если селектор не задан, то свойство указывает привязку окна к рабочей области основного экрана.</td></tr><tr><td>Смещение X</td><td>[Число] Смещение по координате X при отображении окна. Если селектор не задан и угол привязки равен "Default", а данное свойство имеет значение, то это значение будет считаться абсолютными координатами для отображения окна</td></tr><tr><td>Смещение Y</td><td>[Число] Смещение по координате Y при отображении окна. Если селектор не задан и угол привязки равен "Default", а данное свойство имеет значение, то это значение будет считаться абсолютными координатами для отображения окна</td></tr><tr><td>Событие элемента</td><td>[Текст] Сгенерированное событие элементом на форме. Формат значения: "ControlName.EventName". Если кнопка на форме содержит значение DialogResult, то это значение будет указано в этом свойстве. Например: "OK", "Cancel"</td></tr><tr><td>Объект окна</td><td>[Объект] Возвращается созданный объект окна. Данное свойство полезно если показывать окно без использования модальности. Для этого в следующем блоке укажите переменную из этого свйоства. В этом случае произойдет обновление данных в окне без создания нового экземпляра окна</td></tr><tr><td>Уровень обработки</td><td>Выбор уровня обработки ошибок. Возможные значения: "Default" - по умолчанию; "Ignore" - ошибки игнорируются; "Handle" - ошибки обрабатываются. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Уровень сообщений</td><td>Выбор уровня сообщений, которые будут выводить блоки при работе. Возможные значения: "Default" - по умолчанию; "Release" - вывод отключен; "Debug" - вывод основной информации; "Detailed" - вывод подробной информации. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Текст ошибки</td><td>[Текст] Возвращает подробную информацию об ошибке в случае некорректного выполнения работы блока</td></tr></tbody></table>

### Окно с сообщением

Показать пользователю модальное диалоговое окно с заданным заголовком, текстом и набором кнопок. Если используется окно с несколькими кнопками, блок позволяет записать в переменную текстовую константу, соответствующую нажатой пользователем кнопке.

<table data-header-hidden><thead><tr><th width="205"></th><th></th></tr></thead><tbody><tr><td>Заголовок</td><td>[Текст] Текст, значение переменной или результат вычислений, который будет отображен в заголовке диалогового окна</td></tr><tr><td>Сообщение</td><td>[Текст] Текст, значение переменной или результат вычислений, который будет отображен  внутри диалогового окна</td></tr><tr><td>Кнопки</td><td>Кнопки, которые будут доступны пользователю для нажатия</td></tr><tr><td>Изображение</td><td>Изображение, которое будет отображаться в диалоговом окне</td></tr><tr><td>Время ожидания</td><td>[Число] Время ожидания. Если задано значение больше нуля, то окно автоматически закроется через это время. В свойство "Результат" при этом будет записано первое значение из указанных в свойстве "Кнопки".</td></tr><tr><td>Перенос строк</td><td>Включается перенос строк</td></tr><tr><td>Результат</td><td>[Текст] Переменная, в которую будет сохранено название кнопки, нажатой пользователем. Один из возможных результатов: OK, Cancel, Yes, No. Данные текстовые константы не зависят от языка робота или операционной системы</td></tr><tr><td>Уровень обработки</td><td>Выбор уровня обработки ошибок. Возможные значения: "Default" - по умолчанию; "Ignore" - ошибки игнорируются; "Handle" - ошибки обрабатываются. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Уровень сообщений</td><td>Выбор уровня сообщений, которые будут выводить блоки при работе. Возможные значения: "Default" - по умолчанию; "Release" - вывод отключен; "Debug" - вывод основной информации; "Detailed" - вывод подробной информации. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Текст ошибки</td><td>[Текст] Возвращает подробную информацию об ошибке в случае некорректного выполнения работы блока</td></tr></tbody></table>

### Окно для ввода текста

Показать модальное диалоговое окно, предназначенное для получения информации от пользователя.

<table data-header-hidden><thead><tr><th width="240"></th><th></th></tr></thead><tbody><tr><td>Заголовок</td><td>[Текст] Текст, значение переменной или результат вычислений, который будет отображен в заголовке диалогового окна</td></tr><tr><td>Сообщение</td><td>[Текст] Текст, значение переменной или результат вычислений, который будет отображен  внутри диалогового окна</td></tr><tr><td>Значение по умолчанию</td><td>[Текст] Значение, которое сразу будет отображаться в окне ввода. Если пользователь отменит ввод, то это значение будет присвоено результату</td></tr><tr><td>Время ожидания</td><td>[Число] Время ожидания. Если задано значение больше нуля, то окно автоматически закроется через это время. В свойство "Результат" при этом будет записано значение по умолчанию</td></tr><tr><td>Перенос строк</td><td>Включается перенос строк</td></tr><tr><td>Результат</td><td>[Текст] В указанную переменную будет сохранен текст, который пользователь ввел в диалоговое окно</td></tr><tr><td>Уровень обработки</td><td>Выбор уровня обработки ошибок. Возможные значения: "Default" - по умолчанию; "Ignore" - ошибки игнорируются; "Handle" - ошибки обрабатываются. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Уровень сообщений</td><td>Выбор уровня сообщений, которые будут выводить блоки при работе. Возможные значения: "Default" - по умолчанию; "Release" - вывод отключен; "Debug" - вывод основной информации; "Detailed" - вывод подробной информации. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Текст ошибки</td><td>[Текст] Возвращает подробную информацию об ошибке в случае некорректного выполнения работы блока</td></tr></tbody></table>

### Выбор папки

Отображает диалоговое окно, позволяющее пользователю выбрать папку.

&#x20;

<table data-header-hidden><thead><tr><th width="211"></th><th></th></tr></thead><tbody><tr><td>Заголовок</td><td>[Текст] Текст, значение переменной или результат вычислений, который будет отображен в заголовке диалогового окна</td></tr><tr><td>Результат</td><td>[Текст] В указанную переменную будет сохранена выбранная папка</td></tr><tr><td>Уровень обработки</td><td>Выбор уровня обработки ошибок. Возможные значения: "Default" - по умолчанию; "Ignore" - ошибки игнорируются; "Handle" - ошибки обрабатываются. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Направление выхода</td><td>Выбор направления выхода из блока при возникновении ошибки. Возможные значения: "Default" - по умолчанию; "Right" - направо; "Bottom" - вниз. Данное свойство позволяет определить направление выхода при возникновении ошибок для блоков не содержащих коннектора "Если ошибка" (например блок "Условие"). Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Уровень сообщений</td><td>Выбор уровня сообщений, которые будут выводить блоки при работе. Возможные значения: "Default" - по умолчанию; "Release" - вывод отключен; "Debug" - вывод основной информации; "Detailed" - вывод подробной информации. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Текст ошибки</td><td>[Текст] Возвращает подробную информацию об ошибке в случае некорректного выполнения работы блока</td></tr></tbody></table>

### Открыть файл

Отображает диалоговое окно, позволяющее пользователю открыть файл.

<table data-header-hidden><thead><tr><th width="255"></th><th></th></tr></thead><tbody><tr><td>Заголовок</td><td>[Текст] Текст, значение переменной или результат вычислений, который будет отображен в заголовке диалогового окна</td></tr><tr><td>Фильтр</td><td>[Текст] При необходимости можно задать фильтр файлов. Для каждого параметра фильтрации строка фильтра содержит описание фильтра, за которым следуют вертикальная черта (|) и шаблон фильтра. Строки для различных параметров фильтрации разделяются вертикальной чертой. Например: "Text files (*.txt)|*.txt|All files (*.*)|*.*" - в диалоге будет дан выбор между двумя параметрами: "Text files (*.txt)" и "All files (*.*)"</td></tr><tr><td>Расширение по умолчанию</td><td>[Текст] Расширение имени файла по умолчанию. Свойство используется только в том случае, если в поле фильтра выбрано "Все файлы (*.*)" и пользователь не указал расширение. Например: "txt" (без точки)</td></tr><tr><td>Путь к файлу</td><td>[Текст] Возвращается путь к файлу, который выбрал пользователь</td></tr><tr><td>Уровень обработки</td><td>Выбор уровня обработки ошибок. Возможные значения: "Default" - по умолчанию; "Ignore" - ошибки игнорируются; "Handle" - ошибки обрабатываются. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Направление выхода</td><td>Выбор направления выхода из блока при возникновении ошибки. Возможные значения: "Default" - по умолчанию; "Right" - направо; "Bottom" - вниз. Данное свойство позволяет определить направление выхода при возникновении ошибок для блоков не содержащих коннектора "Если ошибка" (например блок "Условие"). Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Уровень сообщений</td><td>Выбор уровня сообщений, которые будут выводить блоки при работе. Возможные значения: "Default" - по умолчанию; "Release" - вывод отключен; "Debug" - вывод основной информации; "Detailed" - вывод подробной информации. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Текст ошибки</td><td>[Текст] Возвращает подробную информацию об ошибке в случае некорректного выполнения работы блока</td></tr></tbody></table>

### Сохранить файл

Отображает диалоговое окно, позволяющее пользователю сохранить файл.

<table data-header-hidden><thead><tr><th width="255"></th><th></th></tr></thead><tbody><tr><td>Заголовок</td><td>[Текст] Текст, значение переменной или результат вычислений, который будет отображен в заголовке диалогового окна</td></tr><tr><td>Фильтр</td><td>[Текст] При необходимости можно задать фильтр файлов. Для каждого параметра фильтрации строка фильтра содержит описание фильтра, за которым следуют вертикальная черта (|) и шаблон фильтра. Строки для различных параметров фильтрации разделяются вертикальной чертой. Например: "Text files (*.txt)|*.txt|All files (*.*)|*.*" - в диалоге будет дан выбор между двумя параметрами: "Text files (*.txt)" и "All files (*.*)"</td></tr><tr><td>Расширение по умолчанию</td><td>[Текст] Расширение имени файла по умолчанию. Свойство используется только в том случае, если в поле фильтра выбрано "Все файлы (*.*)" и пользователь не указал расширение. Например: "txt" (без точки)</td></tr><tr><td>Имя файла по умолчанию</td><td>[Текст] Имя файла, которое будет отображаться в окне ввода</td></tr><tr><td>Уровень обработки</td><td>Выбор уровня обработки ошибок. Возможные значения: "Default" - по умолчанию; "Ignore" - ошибки игнорируются; "Handle" - ошибки обрабатываются. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Путь к файлу</td><td>[Текст] Возвращается путь к файлу, который выбрал пользователь</td></tr><tr><td>Направление выхода</td><td>Выбор направления выхода из блока при возникновении ошибки. Возможные значения: "Default" - по умолчанию; "Right" - направо; "Bottom" - вниз. Данное свойство позволяет определить направление выхода при возникновении ошибок для блоков не содержащих коннектора "Если ошибка" (например блок "Условие"). Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Уровень сообщений</td><td>Выбор уровня сообщений, которые будут выводить блоки при работе. Возможные значения: "Default" - по умолчанию; "Release" - вывод отключен; "Debug" - вывод основной информации; "Detailed" - вывод подробной информации. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Текст ошибки</td><td>[Текст] Возвращает подробную информацию об ошибке в случае некорректного выполнения работы блока</td></tr></tbody></table>

### Man in the loop

Блок позволяет перепроверять списки, словари и таблицы. Вносить правки в реальном времени. В свойствах блока можно указывать необходимые данные для просмотра и редактирования. Не используемые свойства необходимо оставить пустыми.

После заполнения свойств и запуска робота с данным блоком на экран будет выводится диалоговое окно, которое позволяет наглядно перепроверять указанные в свойствах списки, словари и таблицы, в котором можно будет сразу внести правки.&#x20;

**Примечание:** _желательно не оставлять пустым свойство "Путь к файлу", потому как оно отображает ключевую информацию, о чем идет речь._

<table data-header-hidden><thead><tr><th width="205"></th><th></th></tr></thead><tbody><tr><td>Путь к файлу</td><td>[Текст] Путь к файлу. Указывается файл, который можно открыть в предпросмотре. Поддерживаемые форматы: .pdf; .png; .jpg; .jpeg; .bmp</td></tr><tr><td>Список</td><td>[Список] Список для просмотра и редактирования</td></tr><tr><td>Словарь</td><td>[Словарь] Словарь для просмотра и редактирования</td></tr><tr><td>Таблица данных</td><td>[Таблица Данных] Таблица данных для просмотра и редактирования</td></tr><tr><td>Названия кнопок</td><td>Названия кнопок для отображения в окне блока. Возможные значения: OK/Cancel - ОК/Отмена; Accept/Reject  - Принять/Отклонить; Custom - свое значение, которое указывается в свойстве "Свои названия"</td></tr><tr><td>Свои названия</td><td>[Текст] Свои названия кнопок для отображения в окне. Чтобы использовать это свойство необходимо в свойстве "Названия кнопок" выбрать "Custom". Названия разделяются символом /: например "Название1/Название2"</td></tr><tr><td>Список</td><td>[Список] Отредактированный список</td></tr><tr><td>Словарь</td><td>[Словарь] Отредактированный словарь</td></tr><tr><td>Таблица данных</td><td>[Таблица Данных] Отредактированная таблица данных</td></tr><tr><td>Кнопка</td><td>[Текст] Название кнопки, на которую нажали в окне блока</td></tr><tr><td>Уровень обработки</td><td>Выбор уровня обработки ошибок. Возможные значения: "Default" - по умолчанию; "Ignore" - ошибки игнорируются; "Handle" - ошибки обрабатываются. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Уровень сообщений</td><td>Выбор уровня сообщений, которые будут выводить блоки при работе. Возможные значения: "Default" - по умолчанию; "Release" - вывод отключен; "Debug" - вывод основной информации; "Detailed" - вывод подробной информации. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Текст ошибки</td><td>[Текст] Возвращает подробную информацию об ошибке в случае некорректного выполнения работы блока</td></tr></tbody></table>

### Медиаплеер

Воспроизведение аудио-файлов.

<table data-header-hidden><thead><tr><th width="196"></th><th></th></tr></thead><tbody><tr><td>Воспроизвести</td><td>Выбор типа воспроизведения. Возможные значения: "File" - воспроизводит заданный в свойстве "Путь к файлу" файл; остальные значения воспроизводят звуки из текущей звуковой схемы Windows</td></tr><tr><td>Путь к файлу</td><td>[Текст] Имя и путь к файлу, который необходимо воспроизвести. Поддерживаются все форматы файлов, содержащие аудио-дорожку. Например: wav;mp3;mp4;avi;mkv и другие</td></tr><tr><td>Играть в фоне</td><td>Если выбрано, то файл будет воспроизводится в фоне, а работа диаграммы продолжится не останавливаясь. Иначе работа остановится пока файл не будет проигран полностью</td></tr><tr><td>Уровень обработки</td><td>Выбор уровня обработки ошибок. Возможные значения: "Default" - по умолчанию; "Ignore" - ошибки игнорируются; "Handle" - ошибки обрабатываются. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Уровень сообщений</td><td>Выбор уровня сообщений, которые будут выводить блоки при работе. Возможные значения: "Default" - по умолчанию; "Release" - вывод отключен; "Debug" - вывод основной информации; "Detailed" - вывод подробной информации. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Текст ошибки</td><td>[Текст] Возвращает подробную информацию об ошибке в случае некорректного выполнения работы блока</td></tr></tbody></table>

&#x20;

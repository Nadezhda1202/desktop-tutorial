# Получить письма через IMAP (GetIMAPMailMessages)

Получить письма с использованием протокола IMAP.

<table data-header-hidden><thead><tr><th width="235" valign="top"></th><th width="291" valign="top"></th></tr></thead><tbody><tr><td valign="top">Сервер</td><td valign="top">[Текст] Сервер (например, <code>"imap.mail.ru"</code>).</td></tr><tr><td valign="top">Порт</td><td valign="top"><p>[Число] Порт. Если значение не указано, то принимается порт по умолчанию: </p><ul><li>обычное соединение - 143, </li><li>защищенное соединение - 993.</li></ul></td></tr><tr><td valign="top">Логин</td><td valign="top">[Текст] Логин, необходимый для авторизации на сервере.</td></tr><tr><td valign="top">Пароль</td><td valign="top">[Текст/SecureString] Пароль необходимый для авторизации на сервере.</td></tr><tr><td valign="top">Время ожидания</td><td valign="top">[Число] Время ожидания ответа от сервера. Значение указывается в секундах.</td></tr><tr><td valign="top">SSL</td><td valign="top">Указывает, использовать ли защищенное соединение.</td></tr><tr><td valign="top">Количество писем</td><td valign="top">[Число] Число последних писем, которые будут получены с сервера.</td></tr><tr><td valign="top">Удалять после получения</td><td valign="top">Удалять письма с почтового сервера после их получения.</td></tr><tr><td valign="top">Отмечать как прочитанное</td><td valign="top">Отмечать письма как прочитанные после получения.</td></tr><tr><td valign="top">Только новые</td><td valign="top">Получать только новые письма.</td></tr><tr><td valign="top">Сортировать по дате</td><td valign="top"><p>Тип сортировки по дате. </p><p>Возможные варианты: </p><ul><li>NewestFirst - новые сообщения будут первыми в списке; </li><li>OldestFirst - старые сообщения будут первые в списке.</li></ul></td></tr><tr><td valign="top">Фильтр заголовка письма</td><td valign="top">[Текст] Фильтр заголовка письма. Формат фильтра зависит от свойства "Тип фильтра заголовка письма".</td></tr><tr><td valign="top">Тип фильтра заголовка письма</td><td valign="top"><p>Тип фильтра заголовка письма. Возможные значения: </p><ul><li>Contains - простая проверка на содержание текста (эта проверка происходит на сервере и является самой быстрой); </li><li>Wildcard - использование метасимволов (*, ?); </li><li>Regex - использование регулярных выражений. </li></ul><p>Фильтры Wildcard и Regex выполняются после получения писем и являются самыми ресурсозатратными. Рекомендуется их использовать только с установленным свойством "Только новые".</p></td></tr><tr><td valign="top">Папка</td><td valign="top"><p>[Текст] Папка на почтовом сервере для получения почты. Если значение пустое, то будет использоваться папка "Входящие" или "Inbox". </p><p></p><p>При необходимости укажите вложенные папки через символ <code>'\'</code>. Например, <code>"Inbox\TestFolder"</code>.</p></td></tr><tr><td valign="top">Результат</td><td valign="top">[Список] Список объектов MailMessage, которые являются письмами со всем содержимым.</td></tr><tr><td valign="top">Уровень обработки</td><td valign="top"><p>Выбор уровня обработки ошибок. Возможные значения: </p><ul><li>"Default" - по умолчанию; </li><li>"Ignore" - ошибки игнорируются; </li><li>"Handle" - ошибки обрабатываются. </li></ul><p>Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы.</p></td></tr><tr><td valign="top">Уровень сообщений</td><td valign="top"><p>Выбор уровня сообщений, который будут выводить блоки при работе. Возможные значения: </p><ul><li>"Default" - по умолчанию; </li><li>"Release" - вывод отключен; </li><li>"Debug" - вывод основной информации; </li><li>"Detailed" - вывод подробной информации. </li></ul><p>Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы.</p></td></tr><tr><td valign="top">Текст ошибки</td><td valign="top">[Текст] Возвращает подробную информацию об ошибке в случае некорректного выполнения работы блока.</td></tr></tbody></table>

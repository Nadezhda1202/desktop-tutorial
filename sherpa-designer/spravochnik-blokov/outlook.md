# Outlook

### Получить письма

Получить письма через Outlook.

<table data-header-hidden><thead><tr><th width="225"></th><th></th></tr></thead><tbody><tr><td>Email</td><td>[Текст] Email-адрес, с которого необходимо получить список последних писем</td></tr><tr><td>Имя папки</td><td>[Текст] Имя папки в Outlook. Например: "Входящие" или "Inbox". При необходимости укажите вложенные папки через символ '\'. Например: "Inbox\TestFolder"</td></tr><tr><td>Количество писем</td><td>[Число] Количество последних полученных писем, которые необходимо добавить в итоговый список</td></tr><tr><td>Фильтр</td><td>[Текст] Фильтр для получения писем. Формат фильтра соответствует формату метода Items.Restrict (Outlook). Примеры можно увидеть в редакторе выражений в категории "Фильтры для Outlook"</td></tr><tr><td>Только непрочитанные</td><td>Если включено, то будут получены только непрочитанные письма</td></tr><tr><td>Помечать как прочитанное</td><td>Если включено, то все полученные непрочитанные сообщения будут помечены как прочитанные</td></tr><tr><td>Результат</td><td>[Список] Возвращает список объектов MailItem, каждый из которых представляет из себя письмо с данными. Нумерация начинается с нуля. Пример доступных свойств: Body - простой текст сообщения; HTMLBody - текст сообщения в формате HTML; Sender.Address - email отправителя; Sender.Name - имя отправителя (если есть); Subject - тема письма. Например получаем email отправителя первого сообщения: $Result[0].Sender.Address</td></tr><tr><td>Уровень обработки</td><td>Выбор уровня обработки ошибок. Возможные значения: "Default" - по умолчанию; "Ignore" - ошибки игнорируются; "Handle" - ошибки обрабатываются. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Уровень сообщений</td><td>Выбор уровня сообщений, которые будут выводить блоки при работе. Возможные значения: "Default" - по умолчанию; "Release" - вывод отключен; "Debug" - вывод основной информации; "Detailed" - вывод подробной информации. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Текст ошибки</td><td>[Текст] Возвращает подробную информацию об ошибке в случае некорректного выполнения работы блока</td></tr></tbody></table>

### Отправить письмо

Отправить письмо через Outlook.

<table data-header-hidden><thead><tr><th width="205"></th><th></th></tr></thead><tbody><tr><td>Email получателя</td><td>[Текст] Email-адрес получателя, которому необходимо отправить письмо. Для указания нескольких адресатов запишите их в строке через точку с запятой</td></tr><tr><td>Тема письма</td><td>[Текст] Тема письма, отражающая основное содержание сообщения</td></tr><tr><td>Текст письма</td><td>[Текст] Сообщение, которое необходимо отправить адресату</td></tr><tr><td>HTML-разметка</td><td>Если стоит галочка, то содержимое письма будет отправлено как HTML страница и может содержать теги</td></tr><tr><td>Вложения</td><td>[Текст/Список/Словарь] Путь к файлу / Список путей к файлам / Словарь с файлами, которые будут прикреплены к письму (ключ - название, значение - путь к файлу)</td></tr><tr><td>Имя аккаунта</td><td>[Текст] Имя аккаунта, от которого необходимо отправить письмо. Если значение не указано, то используется аккаунт по умолчанию</td></tr><tr><td>Отправить от имени</td><td>[Текст] Указывается имя, которое будет отображаться как отправитель письма</td></tr><tr><td>Копия</td><td>[Текст] Email-адрес получателя для получения копии письма. Для указания нескольких адресатов запишите их в строке через точку с запятой</td></tr><tr><td>Скрытая копия</td><td>[Текст] Email-адрес получателя для получения скрытой копии письма. Для указания нескольких адресатов запишите их в строке через точку с запятой</td></tr><tr><td>В черновик</td><td>При включении свойства письмо будет сохранено в черновики. Письмо при этом отправлено не будет</td></tr><tr><td>Уровень обработки</td><td>Выбор уровня обработки ошибок. Возможные значения: "Default" - по умолчанию; "Ignore" - ошибки игнорируются; "Handle" - ошибки обрабатываются. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Уровень сообщений</td><td>Выбор уровня сообщений, которые будут выводить блоки при работе. Возможные значения: "Default" - по умолчанию; "Release" - вывод отключен; "Debug" - вывод основной информации; "Detailed" - вывод подробной информации. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Текст ошибки</td><td>[Текст] Возвращает подробную информацию об ошибке в случае некорректного выполнения работы блока</td></tr></tbody></table>

### Переслать письмо

Переслать письмо через Outlook.

<table data-header-hidden><thead><tr><th width="203"></th><th></th></tr></thead><tbody><tr><td>Письмо</td><td>[Ссылка] Объект письма MailItem, которое необходимо сохранить. Этот объект письма получается в блоке "Получить письма" категории Outlook</td></tr><tr><td>Email получателя</td><td>[Текст] Email-адрес получателя, которому необходимо отправить письмо. Для указания нескольких адресатов запишите их в строке через точку с запятой</td></tr><tr><td>Тема письма</td><td>[Текст] Тема письма, отражающая основное содержание сообщения</td></tr><tr><td>Текст письма</td><td>[Текст] Сообщение, которое будет добавлено в начале пересылаемого текста сообщения</td></tr><tr><td>Отправить от имени</td><td>[Текст] Указывается имя, которое будет отображаться как отправитель письма</td></tr><tr><td>Копия</td><td>[Текст] Email-адрес получателя для получения копии письма. Для указания нескольких адресатов запишите их в строке через точку с запятой</td></tr><tr><td>Скрытая копия</td><td>[Текст] Email-адрес получателя для получения скрытой копии письма. Для указания нескольких адресатов запишите их в строке через точку с запятой</td></tr><tr><td>Уровень обработки</td><td>Выбор уровня обработки ошибок. Возможные значения: "Default" - по умолчанию; "Ignore" - ошибки игнорируются; "Handle" - ошибки обрабатываются. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Уровень сообщений</td><td>Выбор уровня сообщений, которые будут выводить блоки при работе. Возможные значения: "Default" - по умолчанию; "Release" - вывод отключен; "Debug" - вывод основной информации; "Detailed" - вывод подробной информации. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Текст ошибки</td><td>[Текст] Возвращает подробную информацию об ошибке в случае некорректного выполнения работы блока</td></tr></tbody></table>

### Скачать вложение

Скачать вложенный файл на компьютер пользователя.

<table data-header-hidden><thead><tr><th width="198"></th><th></th></tr></thead><tbody><tr><td>Письмо</td><td>[Ссылка] Объект письма MailItem, которое необходимо сохранить. Этот объект письма получается в блоке "Получить письма" категории Outlook</td></tr><tr><td>Путь к папке</td><td>[Текст] Директория, в которую необходимо сохранить указанное вложение</td></tr><tr><td>Фильтр</td><td>[Текст] Представляет собой регулярное выражение, которое проверяется на предмет соответствия именам сохраняемых файлов вложений. Например: фильтр для файлов xlsx: ".*\.xlsx"</td></tr><tr><td>Результат</td><td>[Список] Список с полными путями сохраненных файлов</td></tr><tr><td>Уровень обработки</td><td>Выбор уровня обработки ошибок. Возможные значения: "Default" - по умолчанию; "Ignore" - ошибки игнорируются; "Handle" - ошибки обрабатываются. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Уровень сообщений</td><td>Выбор уровня сообщений, которые будут выводить блоки при работе. Возможные значения: "Default" - по умолчанию; "Release" - вывод отключен; "Debug" - вывод основной информации; "Detailed" - вывод подробной информации. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Текст ошибки</td><td>[Текст] Возвращает подробную информацию об ошибке в случае некорректного выполнения работы блока</td></tr></tbody></table>

### Сохранить письмо

Сохранить письмо на компьютер пользователя.

<table data-header-hidden><thead><tr><th width="210"></th><th></th></tr></thead><tbody><tr><td>Письмо</td><td>[Ссылка] Объект письма MailItem, которое необходимо сохранить. Этот объект письма получается в блоке "Получить письма" категории Outlook</td></tr><tr><td>Путь к папке</td><td>[Текст] Директория, в которую необходимо сохранить указанное письмо</td></tr><tr><td>Уровень обработки</td><td>Выбор уровня обработки ошибок. Возможные значения: "Default" - по умолчанию; "Ignore" - ошибки игнорируются; "Handle" - ошибки обрабатываются. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Уровень сообщений</td><td>Выбор уровня сообщений, которые будут выводить блоки при работе. Возможные значения: "Default" - по умолчанию; "Release" - вывод отключен; "Debug" - вывод основной информации; "Detailed" - вывод подробной информации. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Текст ошибки</td><td>[Текст] Возвращает подробную информацию об ошибке в случае некорректного выполнения работы блока</td></tr></tbody></table>

### Получить список папок

Получить список Outlook-папок.

<table data-header-hidden><thead><tr><th width="201"></th><th></th></tr></thead><tbody><tr><td>Email</td><td>[Текст] Целевой Email в приложении Outlook</td></tr><tr><td>Список папок</td><td>[Список] Возвращает список папок Outlook</td></tr><tr><td>Уровень обработки</td><td>Выбор уровня обработки ошибок. Возможные значения: "Default" - по умолчанию; "Ignore" - ошибки игнорируются; "Handle" - ошибки обрабатываются. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Уровень сообщений</td><td>Выбор уровня сообщений, которые будут выводить блоки при работе. Возможные значения: "Default" - по умолчанию; "Release" - вывод отключен; "Debug" - вывод основной информации; "Detailed" - вывод подробной информации. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Текст ошибки</td><td>[Текст] Возвращает подробную информацию об ошибке в случае некорректного выполнения работы блока</td></tr></tbody></table>

### Переместить письмо в папку

Переместить Outlook-письмо в указанную папку.

<table data-header-hidden><thead><tr><th width="211"></th><th></th></tr></thead><tbody><tr><td>Email</td><td>[Текст] Целевой Email в приложении Outlook</td></tr><tr><td>Письмо</td><td>[Ссылка] Ссылка на объект письма EmailObject, которое нужно переместить</td></tr><tr><td>Папка</td><td>[Текст] Имя папки в Outlook. Например: "Входящие" или "Inbox". При необходимости укажите вложенные папки через символ '\'. Например: "Inbox\TestFolder"</td></tr><tr><td>Уровень обработки</td><td>Выбор уровня обработки ошибок. Возможные значения: "Default" - по умолчанию; "Ignore" - ошибки игнорируются; "Handle" - ошибки обрабатываются. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Уровень сообщений</td><td>Выбор уровня сообщений, которые будут выводить блоки при работе. Возможные значения: "Default" - по умолчанию; "Release" - вывод отключен; "Debug" - вывод основной информации; "Detailed" - вывод подробной информации. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Текст ошибки</td><td>[Текст] Возвращает подробную информацию об ошибке в случае некорректного выполнения работы блока</td></tr></tbody></table>

### Извлечь e-mail отправителя из письма

Извлекает e-mail отправителя из письма.

<table data-header-hidden><thead><tr><th width="211"></th><th></th></tr></thead><tbody><tr><td>Письмо</td><td>[Ссылка] Объект письма MailItem. Этот объект письма получается в блоке "Получить письма" категории Outlook</td></tr><tr><td>Результат</td><td>[Текст] E-mail отправителя</td></tr><tr><td>Уровень обработки</td><td>Выбор уровня обработки ошибок. Возможные значения: "Default" - по умолчанию; "Ignore" - ошибки игнорируются; "Handle" - ошибки обрабатываются. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Уровень сообщений</td><td>Выбор уровня сообщений, которые будут выводить блоки при работе. Возможные значения: "Default" - по умолчанию; "Release" - вывод отключен; "Debug" - вывод основной информации; "Detailed" - вывод подробной информации. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Текст ошибки</td><td>[Текст] Возвращает подробную информацию об ошибке в случае некорректного выполнения работы блока</td></tr></tbody></table>

### Загрузить файл msg

Загружает файл в формате .msg, который является сохраненным письмом.

<table data-header-hidden><thead><tr><th width="225"></th><th></th></tr></thead><tbody><tr><td>Имя файла</td><td>[Текст] Имя и путь к файлу msg</td></tr><tr><td>Результат</td><td>[Объект] Возвращается объект письма</td></tr><tr><td>Уровень обработки</td><td>Выбор уровня обработки ошибок. Возможные значения: "Default" - по умолчанию; "Ignore" - ошибки игнорируются; "Handle" - ошибки обрабатываются. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Уровень сообщений</td><td>Выбор уровня сообщений, которые будут выводить блоки при работе. Возможные значения: "Default" - по умолчанию; "Release" - вывод отключен; "Debug" - вывод основной информации; "Detailed" - вывод подробной информации. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Текст ошибки</td><td>[Текст] Возвращает подробную информацию об ошибке в случае некорректного выполнения работы блока</td></tr></tbody></table>

&#x20;

# Удаленный рабочий стол RDP/Citrix

### Генерация подключения

Генерация подключения с удаленным компьютером через RDP. Результатом блока является строка данных, которая идентична содержимому файла .rdp.

<table data-header-hidden><thead><tr><th width="268"></th><th></th></tr></thead><tbody><tr><td>Сервер</td><td>[Текст] Сервер для подключения. Указывается IP адрес или домен</td></tr><tr><td>Порт</td><td>[Число] Порт для подключения. Если указать пустое значение, то принимается порт по умолчанию (3389)</td></tr><tr><td>Имя пользователя</td><td>[Текст] Имя пользователя для авторизации</td></tr><tr><td>Пароль</td><td>[Текст/SecureString] Пароль для авторизации</td></tr><tr><td>Строка подключения</td><td>[Текст] Строка данных для подключения к удаленному компьютеру. Содержимое строки идентично содержимому файлов .rdp</td></tr><tr><td>Настройка отображения</td><td>Позволяет выбрать в каком размере будет инициализирован экран удаленного компьютера. Возможные значения: Full screen - полноэкранный режим; остальные значения "Ширина"x"Высота" экрана</td></tr><tr><td>Перенаправление принтеров</td><td>При включении локальные принтеры будут перенаправлены на удаленную машину</td></tr><tr><td>Перенаправление буфера обмена</td><td>При включении на удаленной машине будет доступен локальный буфер обмена</td></tr><tr><td>Качество подключения</td><td>Качество подключения. Возможные значения: Auto - определять качество подключения автоматически; Maximum - будут включены все возможности; Normal - включаются возможности "Сглаживание шрифтов", "Композиция рабочего стола", "Стили оформления"; Minimum - отключаются все возможности</td></tr><tr><td>Уровень обработки</td><td>Выбор уровня обработки ошибок. Возможные значения: "Default" - по умолчанию; "Ignore" - ошибки игнорируются; "Handle" - ошибки обрабатываются. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Уровень сообщений</td><td>Выбор уровня сообщений, которые будут выводить блоки при работе. Возможные значения: "Default" - по умолчанию; "Release" - вывод отключен; "Debug" - вывод основной информации; "Detailed" - вывод подробной информации. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Текст ошибки</td><td>[Текст] Возвращает подробную информацию об ошибке в случае некорректного выполнения работы блока</td></tr></tbody></table>

### Создание подключения

Создание подключения с удаленным компьютером по протоколу RDP.

<table data-header-hidden><thead><tr><th width="205"></th><th></th></tr></thead><tbody><tr><td>Строка подключения</td><td>[Текст] Строка подключения или путь к файлу rdp. В свойстве указыватся строка подключения, генерируемая блоком "Генерация подключения" из этой же категории. Также есть возможность указать путь к файлу rdp</td></tr><tr><td>Время ожидания</td><td>[Число] Время ожидания подключения</td></tr><tr><td>ID процесса</td><td>[Ссылка] Переменная, в которой хранится идентификатор процесса. Указывает, с каким приложением необходимо работать. Если указанное приложение свернуто или его окно закрыто другими окнами, то оно будет выведено на передний план. При работе с браузерами ID процесса дополнительно указывает на конкретную вкладку браузера, с которой должен работать блок. Если свойство оставить пустым, либо если переменная ID процесса не была ранее присвоена в момент запуска приложения или открытия браузера, приложение и вкладка браузера будут определены из содержимого соответствующей строки селектора. ID процесса может быть получен, например, с помощью блоков Запустить приложение или Получить процесс.</td></tr><tr><td>Уровень обработки</td><td>Выбор уровня обработки ошибок. Возможные значения: "Default" - по умолчанию; "Ignore" - ошибки игнорируются; "Handle" - ошибки обрабатываются. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Уровень сообщений</td><td>Выбор уровня сообщений, которые будут выводить блоки при работе. Возможные значения: "Default" - по умолчанию; "Release" - вывод отключен; "Debug" - вывод основной информации; "Detailed" - вывод подробной информации. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Текст ошибки</td><td>[Текст] Возвращает подробную информацию об ошибке в случае некорректного выполнения работы блока</td></tr></tbody></table>

### Подключиться к сеансу

Подключение к уже созданному сеансу RDP.

[Работа с RDP: удаленный запуск сценария робота и передача файлов с использованием блоков "Подключиться к сеансу" и "Выполнить сценарий" продемонстрированы здесь.](https://sherparpa.ru/ucontent/?8fxu)

<table data-header-hidden><thead><tr><th width="209"></th><th></th></tr></thead><tbody><tr><td>Сервер</td><td>[Текст] Имя сервера. Необходимо указывать значение, с которым инициализировано подключение RDP, к которому следует присоединиться. Для подключения к Citrix укажите значение "Citrix"</td></tr><tr><td>ID процесса</td><td>[Ссылка] Переменная, в которой хранится идентификатор процесса. Указывает, с каким приложением необходимо работать. Если указанное приложение свернуто или его окно закрыто другими окнами, то оно будет выведено на передний план. При работе с браузерами ID процесса дополнительно указывает на конкретную вкладку браузера, с которой должен работать блок. Если свойство оставить пустым, либо если переменная ID процесса не была ранее присвоена в момент запуска приложения или открытия браузера, приложение и вкладка браузера будут определены из содержимого соответствующей строки селектора. ID процесса может быть получен, например, с помощью блоков Запустить приложение или Получить процесс.</td></tr><tr><td>Уровень обработки</td><td>Выбор уровня обработки ошибок. Возможные значения: "Default" - по умолчанию; "Ignore" - ошибки игнорируются; "Handle" - ошибки обрабатываются. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Уровень сообщений</td><td>Выбор уровня сообщений, которые будут выводить блоки при работе. Возможные значения: "Default" - по умолчанию; "Release" - вывод отключен; "Debug" - вывод основной информации; "Detailed" - вывод подробной информации. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Текст ошибки</td><td>[Текст] Возвращает подробную информацию об ошибке в случае некорректного выполнения работы блока</td></tr></tbody></table>

### Закрыть подключение

Закрывает указанное подключение RDP.

<table data-header-hidden><thead><tr><th width="210"></th><th></th></tr></thead><tbody><tr><td>ID процесса</td><td>[Ссылка] Переменная, в которой хранится идентификатор процесса. Указывает, с каким приложением необходимо работать. Если указанное приложение свернуто или его окно закрыто другими окнами, то оно будет выведено на передний план. При работе с браузерами ID процесса дополнительно указывает на конкретную вкладку браузера, с которой должен работать блок. Если свойство оставить пустым, либо если переменная ID процесса не была ранее присвоена в момент запуска приложения или открытия браузера, приложение и вкладка браузера будут определены из содержимого соответствующей строки селектора. ID процесса может быть получен, например, с помощью блоков Запустить приложение или Получить процесс.</td></tr><tr><td>Уровень обработки</td><td>Выбор уровня обработки ошибок. Возможные значения: "Default" - по умолчанию; "Ignore" - ошибки игнорируются; "Handle" - ошибки обрабатываются. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Уровень сообщений</td><td>Выбор уровня сообщений, которые будут выводить блоки при работе. Возможные значения: "Default" - по умолчанию; "Release" - вывод отключен; "Debug" - вывод основной информации; "Detailed" - вывод подробной информации. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Текст ошибки</td><td>[Текст] Возвращает подробную информацию об ошибке в случае некорректного выполнения работы блока</td></tr></tbody></table>

### Отключиться от RDP сессии

Отключение от текущей RDP сессии. При этом текущая сессия будет перенаправлена на консоль. Назначение блока: при работе визуальных сценариев, таких как работа мышки, клавиатуры (например, управление браузером Google Chrome) закрытие окна удаленного подключения приведет к ошибке, при которой теряется активная сессия и перестают работать управляющие элементы. Иными словами при закрытии окна удаленного подключения RDP отключается пользователь и управление мышкой и клавиатурой оказывается невозможным. При использовании блока происходит перенаправление активной сессии на консоль. При этом сохраняется разрешение экрана и остаются доступными управляющие элементы. Само окно RDP подключение будет закрыто. Это так же можно сделать комбинациями клавиш Shift+F4 после запуска робота, а поменять комбинацию можно в настройках робота.

<table data-header-hidden><thead><tr><th width="223"></th><th></th></tr></thead><tbody><tr><td>Ширина рабочего стола</td><td>[Число] Указывается ширина рабочего стола, с которым будет сделано подключение к консоли. Если значение пустое, то будет использоваться текущее разрешение экрана</td></tr><tr><td>Высота рабочего стола</td><td>[Число] Указывается высота рабочего стола, с которым будет сделано подключение к консоли. Если значение пустое, то будет использоваться текущее разрешение экрана</td></tr><tr><td>Уровень обработки</td><td>Выбор уровня обработки ошибок. Возможные значения: "Default" - по умолчанию; "Ignore" - ошибки игнорируются; "Handle" - ошибки обрабатываются. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Уровень сообщений</td><td>Выбор уровня сообщений, которые будут выводить блоки при работе. Возможные значения: "Default" - по умолчанию; "Release" - вывод отключен; "Debug" - вывод основной информации; "Detailed" - вывод подробной информации. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Текст ошибки</td><td>[Текст] Возвращает подробную информацию об ошибке в случае некорректного выполнения работы блока</td></tr></tbody></table>

### Работа с файлами

Блок позволяет загрузить файл на удаленный компьютер или скачать файл.

<table data-header-hidden><thead><tr><th width="204"></th><th></th></tr></thead><tbody><tr><td>ID процесса</td><td>[Ссылка] Переменная, в которой хранится идентификатор процесса. Указывает, с каким приложением необходимо работать. Если указанное приложение свернуто или его окно закрыто другими окнами, то оно будет выведено на передний план. При работе с браузерами ID процесса дополнительно указывает на конкретную вкладку браузера, с которой должен работать блок. Если свойство оставить пустым, либо если переменная ID процесса не была ранее присвоена в момент запуска приложения или открытия браузера, приложение и вкладка браузера будут определены из содержимого соответствующей строки селектора. ID процесса может быть получен, например, с помощью блоков Запустить приложение или Получить процесс.</td></tr><tr><td>Удаленный файл</td><td>[Текст] Полный путь файла на удаленном компьютере</td></tr><tr><td>Локальный файл</td><td>[Текст] Полный путь файла на локальном компьютере</td></tr><tr><td>Операция</td><td>Выполняемая операция. Возможные значения: Upload - загрузка локального файла по пути удаленного файла (загрузка локального файла); Download - скачивание удаленного файла по пути локального файла (скачивание удаленного файла)</td></tr><tr><td>Время ожидания</td><td>[Число] Время ожидания выполнения операции. Если значение равно нулю, то свойство игнорируется и блок будет ожидать полного завершения операции</td></tr><tr><td>Уровень обработки</td><td>Выбор уровня обработки ошибок. Возможные значения: "Default" - по умолчанию; "Ignore" - ошибки игнорируются; "Handle" - ошибки обрабатываются. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Уровень сообщений</td><td>Выбор уровня сообщений, которые будут выводить блоки при работе. Возможные значения: "Default" - по умолчанию; "Release" - вывод отключен; "Debug" - вывод основной информации; "Detailed" - вывод подробной информации. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Текст ошибки</td><td>[Текст] Возвращает подробную информацию об ошибке в случае некорректного выполнения работы блока</td></tr></tbody></table>

### Выполнить сценарий

Выполняет сценарий в формате .robot на удаленной машине.

[Работа с RDP: удаленный запуск сценария робота и передача файлов с использованием блоков "Подключиться к сеансу" и "Выполнить сценарий" продемонстрированы здесь.](https://sherparpa.ru/ucontent/?8fxu)

<table data-header-hidden><thead><tr><th width="244"></th><th></th></tr></thead><tbody><tr><td>ID процесса</td><td>[Ссылка] Переменная, в которой хранится идентификатор процесса. Указывает, с каким приложением необходимо работать. Если указанное приложение свернуто или его окно закрыто другими окнами, то оно будет выведено на передний план. При работе с браузерами ID процесса дополнительно указывает на конкретную вкладку браузера, с которой должен работать блок. Если свойство оставить пустым, либо если переменная ID процесса не была ранее присвоена в момент запуска приложения или открытия браузера, приложение и вкладка браузера будут определены из содержимого соответствующей строки селектора. ID процесса может быть получен, например, с помощью блоков Запустить приложение или Получить процесс.</td></tr><tr><td>Файл robot</td><td>[Текст] Файл сценария с расширением .robot</td></tr><tr><td>Отключить закачку файла</td><td>При включении опции закачка указанного файла не будет выполнена на удаленную машину и будет считаться, что этот файл сразу доступен по пути на удаленной машине (например если указывается путь на сетевой папке)</td></tr><tr><td>Время ожидания запуска</td><td>[Число] Время ожидания запуска сценария на удаленной машине</td></tr><tr><td>Время ожидания</td><td>[Число] Время ожидания выполнения операции. Если значение равно нулю, то свойство игнорируется и блок будет ожидать полного завершения выполнения сценария</td></tr><tr><td>Уровень обработки</td><td>Выбор уровня обработки ошибок. Возможные значения: "Default" - по умолчанию; "Ignore" - ошибки игнорируются; "Handle" - ошибки обрабатываются. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Уровень сообщений</td><td>Выбор уровня сообщений, которые будут выводить блоки при работе. Возможные значения: "Default" - по умолчанию; "Release" - вывод отключен; "Debug" - вывод основной информации; "Detailed" - вывод подробной информации. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Текст ошибки</td><td>[Текст] Возвращает подробную информацию об ошибке в случае некорректного выполнения работы блока</td></tr></tbody></table>

&#x20;

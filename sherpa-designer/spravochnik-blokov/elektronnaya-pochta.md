# Электронная почта

### Получить письма через POP3

Получить письма с использованием протокола POP3.

<table data-header-hidden><thead><tr><th width="198"></th><th></th></tr></thead><tbody><tr><td>Сервер</td><td>[Текст] Сервер (например "pop.mail.ru")</td></tr><tr><td>Порт</td><td>[Число] Порт. Если значение не указано, то принимается порт по умолчанию: обычное соединение - 110, защищенное соединение - 995</td></tr><tr><td>Логин</td><td>[Текст] Логин, необходимый для авторизации на сервере</td></tr><tr><td>Пароль</td><td>[Текст/SecureString] Пароль необходимый для авторизации на сервере</td></tr><tr><td>Время ожидания</td><td>[Число] Время ожидания ответа от сервера. Значение указывается в секундах</td></tr><tr><td>SSL</td><td>Указывает, использовать ли защищенное соединение</td></tr><tr><td>Количество писем</td><td>[Число] Число последних писем, которые будут получены с сервера</td></tr><tr><td>Результат</td><td>[Список] Список объектов MailMessage, которые являются письмами со всем содержимым</td></tr><tr><td>Уровень обработки</td><td>Выбор уровня обработки ошибок. Возможные значения: "Default" - по умолчанию; "Ignore" - ошибки игнорируются; "Handle" - ошибки обрабатываются. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Уровень сообщений</td><td>Выбор уровня сообщений, которые будут выводить блоки при работе. Возможные значения: "Default" - по умолчанию; "Release" - вывод отключен; "Debug" - вывод основной информации; "Detailed" - вывод подробной информации. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Текст ошибки</td><td>[Текст] Возвращает подробную информацию об ошибке в случае некорректного выполнения работы блока</td></tr></tbody></table>

### Получить письма через IMAP

Получить письма с использованием протокола IMAP.

<table data-header-hidden><thead><tr><th width="249"></th><th></th></tr></thead><tbody><tr><td>Сервер</td><td>[Текст] Сервер (например "imap.mail.ru")</td></tr><tr><td>Порт</td><td>[Число] Порт. Если значение не указано, то принимается порт по умолчанию: обычное соединение - 143, защищенное соединение - 993</td></tr><tr><td>Логин</td><td>[Текст] Логин, необходимый для авторизации на сервере</td></tr><tr><td>Пароль</td><td>[Текст/SecureString] Пароль необходимый для авторизации на сервере</td></tr><tr><td>Время ожидания</td><td>[Число] Время ожидания ответа от сервера. Значение указывается в секундах</td></tr><tr><td>SSL</td><td>Указывает, использовать ли защищенное соединение</td></tr><tr><td>Количество писем</td><td>[Число] Число последних писем, которые будут получены с сервера</td></tr><tr><td>Удалять после получения</td><td>Удалять письма с почтового сервера после их получения</td></tr><tr><td>Отмечать как прочитанное</td><td>Отмечать письма как прочитанные после получения</td></tr><tr><td>Только новые</td><td>Получать только новые письма</td></tr><tr><td>Сортировать по дате</td><td>Тип сортировки по дате. Возможные варианты: NewestFirst - новые сообщения будут первыми в списке; OldestFirst - старые сообщения будут первые в списке</td></tr><tr><td>Фильтр заголовка письма</td><td>[Текст] Фильтр заголовка письма. Формат фильтра зависит от свойства "Тип фильтра заголовка письма"</td></tr><tr><td>Тип фильтра заголовка письма</td><td>Тип фильтра заголовка письма. Возможные значения: Contains - простая проверка на содержание текста (эта проверка происходит на сервере и является самой быстрой); Wildcard - использование метасимволов (*, ?); Regex - использование регулярных выражений. Фильтры Wildcard и Regex выполняются после получения писем и являются самыми ресурсозатратными. Рекомендуется их использовать только с установленным свойством "Только новые"</td></tr><tr><td>Папка</td><td>[Текст] Папка на почтовом сервере для получения почты. Если значение пустое, то будет использоваться папка "Входящие" или "Inbox". При необходимости укажите вложенные папки через символ '\'. Например: "Inbox\TestFolder"</td></tr><tr><td>Результат</td><td>[Список] Список объектов MailMessage, которые являются письмами со всем содержимым</td></tr><tr><td>Уровень обработки</td><td>Выбор уровня обработки ошибок. Возможные значения: "Default" - по умолчанию; "Ignore" - ошибки игнорируются; "Handle" - ошибки обрабатываются. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Уровень сообщений</td><td>Выбор уровня сообщений, которые будут выводить блоки при работе. Возможные значения: "Default" - по умолчанию; "Release" - вывод отключен; "Debug" - вывод основной информации; "Detailed" - вывод подробной информации. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Текст ошибки</td><td>[Текст] Возвращает подробную информацию об ошибке в случае некорректного выполнения работы блока</td></tr></tbody></table>

### Получить IMAP папки

Получает список папок и подпапок с сервера IMAP.

<table data-header-hidden><thead><tr><th width="199"></th><th></th></tr></thead><tbody><tr><td>Сервер</td><td>[Текст] Сервер (например "imap.mail.ru")</td></tr><tr><td>Порт</td><td>[Число] Порт. Если значение не указано, то принимается порт по умолчанию: обычное соединение - 143, защищенное соединение - 993</td></tr><tr><td>Логин</td><td>[Текст] Логин, необходимый для авторизации на сервере</td></tr><tr><td>Пароль</td><td>[Текст/SecureString] Пароль необходимый для авторизации на сервере</td></tr><tr><td>Время ожидания</td><td>[Число] Время ожидания ответа от сервера. Значение указывается в секундах</td></tr><tr><td>SSL</td><td>Указывает, использовать ли защищенное соединение</td></tr><tr><td>Результат</td><td>[Список] Список папок и подпапок сервера</td></tr><tr><td>Уровень обработки</td><td>Выбор уровня обработки ошибок. Возможные значения: "Default" - по умолчанию; "Ignore" - ошибки игнорируются; "Handle" - ошибки обрабатываются. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Уровень сообщений</td><td>Выбор уровня сообщений, которые будут выводить блоки при работе. Возможные значения: "Default" - по умолчанию; "Release" - вывод отключен; "Debug" - вывод основной информации; "Detailed" - вывод подробной информации. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Текст ошибки</td><td>[Текст] Возвращает подробную информацию об ошибке в случае некорректного выполнения работы блока</td></tr></tbody></table>

### Переместить письмо через IMAP

Перемещает письмо в другую папку на сервере, используя протокол IMAP. Для перемещения письма его необходимо получить при помощи блока «Получить письма через IMAP».

<table data-header-hidden><thead><tr><th width="195"></th><th></th></tr></thead><tbody><tr><td>Письмо</td><td>[Ссылка] Объект письма MailMessage, которое необходимо переместить. Письмо необходимо получить при помощи блока "Получить письма через IMAP"</td></tr><tr><td>Папка назначения</td><td>[Текст] Папка на почтовом сервере, в которую необходимо переместить письмо. Например: "Входящие" или "Inbox". При необходимости укажите вложенные папки через символ '\'. Например: "Inbox\TestFolder"</td></tr><tr><td>Уровень обработки</td><td>Выбор уровня обработки ошибок. Возможные значения: "Default" - по умолчанию; "Ignore" - ошибки игнорируются; "Handle" - ошибки обрабатываются. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Уровень сообщений</td><td>Выбор уровня сообщений, которые будут выводить блоки при работе. Возможные значения: "Default" - по умолчанию; "Release" - вывод отключен; "Debug" - вывод основной информации; "Detailed" - вывод подробной информации. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Текст ошибки</td><td>[Текст] Возвращает подробную информацию об ошибке в случае некорректного выполнения работы блока</td></tr></tbody></table>

### Отправить письмо

Отправить письмо с использованием протокола SMTP.

<table data-header-hidden><thead><tr><th width="194"></th><th></th></tr></thead><tbody><tr><td>Сервер</td><td>[Текст] Сервер (например "smtp.mail.ru")</td></tr><tr><td>Порт</td><td>[Число] Порт. Если значение не указано, то принимается порт по умолчанию: обычное соединение - 25, защищенное соединение - 587</td></tr><tr><td>Логин</td><td>[Текст] Логин, необходимый для авторизации на сервере</td></tr><tr><td>Пароль</td><td>[Текст/SecureString] Пароль, необходимый для авторизации на сервере</td></tr><tr><td>SSL</td><td>Указывает, использовать ли защищенное соединение</td></tr><tr><td>Email отправителя</td><td>[Текст] Указывается E-mail, с которого будет отправлено письмо</td></tr><tr><td>Имя отправителя</td><td>[Текст] Указывается имя отправителя, от которого будет отправлено письмо</td></tr><tr><td>Email получателя</td><td>[Текст] Email-адрес получателя, которому необходимо отправить письмо. Для указания нескольких адресатов запишите их в строке через точку с запятой</td></tr><tr><td>Тема письма</td><td>[Текст] Тема письма</td></tr><tr><td>Текст письма</td><td>[Текст] Содержимое письма</td></tr><tr><td>HTML-разметка</td><td>Если стоит галочка, то содержимое письма будет отправлено как HTML страница и может содержать теги</td></tr><tr><td>Вложения</td><td>[Текст/Список/Словарь] Путь к файлу / Список путей к файлам / Словарь с файлами, которые будут прикреплены к письму (ключ - название, значение - путь к файлу)</td></tr><tr><td>Время ожидания</td><td>[Число] Время ожидания ответа от сервера. Значение указывается в секундах</td></tr><tr><td>Копия</td><td>[Текст] Email-адрес получателя для получения копии письма. Для указания нескольких адресатов запишите их в строке через точку с запятой</td></tr><tr><td>Скрытая копия</td><td>[Текст] Email-адрес получателя для получения скрытой копии письма. Для указания нескольких адресатов запишите их в строке через точку с запятой</td></tr><tr><td>Уровень обработки</td><td>Выбор уровня обработки ошибок. Возможные значения: "Default" - по умолчанию; "Ignore" - ошибки игнорируются; "Handle" - ошибки обрабатываются. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Уровень сообщений</td><td>Выбор уровня сообщений, которые будут выводить блоки при работе. Возможные значения: "Default" - по умолчанию; "Release" - вывод отключен; "Debug" - вывод основной информации; "Detailed" - вывод подробной информации. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Текст ошибки</td><td>[Текст] Возвращает подробную информацию об ошибке в случае некорректного выполнения работы блока</td></tr></tbody></table>

### Переслать письмо

Пересылает письмо с использованием протокола SMTP

| Сервер            | \[Текст] Сервер (например "smtp.mail.ru")                                                                                                                                                                                                                                                                                 |
| ----------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Порт              | \[Число] Порт. Если значение не указано, то принимается порт по умолчанию: обычное соединение - 25, защищенное соединение - 587                                                                                                                                                                                           |
| Логин             | \[Текст] Логин, необходимый для авторизации на сервере                                                                                                                                                                                                                                                                    |
| Пароль            | \[Текст/SecureString] Пароль, необходимый для авторизации на сервере                                                                                                                                                                                                                                                      |
| SSL               | Указывает, использовать ли защищенное соединение                                                                                                                                                                                                                                                                          |
| Email отправителя | \[Текст] Указывается E-mail, с которого будет отправлено письмо                                                                                                                                                                                                                                                           |
| Имя отправителя   | \[Текст] Указывается имя отправителя, от которого будет отправлено письмо                                                                                                                                                                                                                                                 |
| Письмо            | \[Ссылка] Объект письма MailMessage, которое необходимо переслать                                                                                                                                                                                                                                                         |
| Email получателя  | \[Текст] Email-адрес получателя, которому необходимо отправить письмо. Для указания нескольких адресатов запишите их в строке через точку с запятой                                                                                                                                                                       |
| Уровень обработки | Выбор уровня обработки ошибок. Возможные значения: "Default" - по умолчанию; "Ignore" - ошибки игнорируются; "Handle" - ошибки обрабатываются. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы                                                                           |
| Время ожидания    | \[Число] Время ожидания ответа от сервера. Значение указывается в секундах                                                                                                                                                                                                                                                |
| Уровень сообщений | Выбор уровня сообщений, которые будут выводить блоки при работе. Возможные значения: "Default" - по умолчанию; "Release" - вывод отключен; "Debug" - вывод основной информации; "Detailed" - вывод подробной информации. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы |
| Текст ошибки      | \[Текст] Возвращает подробную информацию об ошибке в случае некорректного выполнения работы блока                                                                                                                                                                                                                         |

### Сохранить письмо

Сохранить письмо на компьютере пользователя.

<table data-header-hidden><thead><tr><th width="210"></th><th></th></tr></thead><tbody><tr><td>Письмо</td><td>[Ссылка] Объект письма MailMessage, которое необходимо сохранить</td></tr><tr><td>Путь</td><td>[Текст] Директория, в которую нужно сохранить письмо</td></tr><tr><td>Уровень обработки</td><td>Выбор уровня обработки ошибок. Возможные значения: "Default" - по умолчанию; "Ignore" - ошибки игнорируются; "Handle" - ошибки обрабатываются. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Уровень сообщений</td><td>Выбор уровня сообщений, которые будут выводить блоки при работе. Возможные значения: "Default" - по умолчанию; "Release" - вывод отключен; "Debug" - вывод основной информации; "Detailed" - вывод подробной информации. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Текст ошибки</td><td>[Текст] Возвращает подробную информацию об ошибке в случае некорректного выполнения работы блока</td></tr></tbody></table>

### Скачать все вложения

Сохраняет все вложения из письма в указанную папку на компьютер пользователя.

<table data-header-hidden><thead><tr><th width="198"></th><th></th></tr></thead><tbody><tr><td>Письмо</td><td>[Ссылка] Объект письма MailMessage, вложения из которого нужно сохранить</td></tr><tr><td>Путь</td><td>[Текст] Директория, в которую нужно сохранить вложения письма</td></tr><tr><td>Фильтр</td><td>[Текст] Представляет собой регулярное выражение, которое проверяется на предмет соответствия именам сохраняемых файлов вложений</td></tr><tr><td>Результат</td><td>[Список] Список с полными путями сохраненных файлов</td></tr><tr><td>Уровень обработки</td><td>Выбор уровня обработки ошибок. Возможные значения: "Default" - по умолчанию; "Ignore" - ошибки игнорируются; "Handle" - ошибки обрабатываются. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Уровень сообщений</td><td>Выбор уровня сообщений, которые будут выводить блоки при работе. Возможные значения: "Default" - по умолчанию; "Release" - вывод отключен; "Debug" - вывод основной информации; "Detailed" - вывод подробной информации. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Текст ошибки</td><td>[Текст] Возвращает подробную информацию об ошибке в случае некорректного выполнения работы блока</td></tr></tbody></table>

### Скачать вложение

Сохраняет указанное вложение в файл на компьютер пользователя.

<table data-header-hidden><thead><tr><th width="221"></th><th></th></tr></thead><tbody><tr><td>Письмо</td><td>[Ссылка] Объект письма MailMessage, вложения из которого нужно сохранить</td></tr><tr><td>Индекс вложения</td><td>[Число] Индекс вложения. Нумерация начинается с нуля. Если вложения с указанным индексом не существует, то блок возвратит ошибку "Index out of range"</td></tr><tr><td>Имя файла</td><td>[Текст] Имя и путь к файлу для сохранения вложения</td></tr><tr><td>Уровень обработки</td><td>Выбор уровня обработки ошибок. Возможные значения: "Default" - по умолчанию; "Ignore" - ошибки игнорируются; "Handle" - ошибки обрабатываются. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Уровень сообщений</td><td>Выбор уровня сообщений, которые будут выводить блоки при работе. Возможные значения: "Default" - по умолчанию; "Release" - вывод отключен; "Debug" - вывод основной информации; "Detailed" - вывод подробной информации. Если выбрано значение "Default", то будет использоваться значение блока "Старт" данной диаграммы</td></tr><tr><td>Текст ошибки</td><td>[Текст] Возвращает подробную информацию об ошибке в случае некорректного выполнения работы блока</td></tr></tbody></table>

&#x20;

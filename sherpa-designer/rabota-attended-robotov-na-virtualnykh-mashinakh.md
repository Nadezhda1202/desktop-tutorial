# Работа Attended роботов на виртуальных машинах

Со стороны Sherpa RPA не делается различий между работой на физическом сервере и виртуальной машине.&#x20;

Однако, при использовании виртуальной машины возникают определённые технические ограничения, связанные с работой Windows, а не самой платформы Sherpa RPA.&#x20;

> В частности, если на виртуальной машине нет активного Пользователя, который работает с графическим интерфейсом (то есть не выполняется наблюдение за экраном со стороны Пользователя), то элементы интерфейса (такие как кнопки и окна) не отображаются на экране. В результате Робот не сможет взаимодействовать с этими элементами.&#x20;

На физическом компьютере видеокарта постоянно обновляет изображение на экране, поэтому интерфейс всегда отображается, и элементы пользовательского интерфейса доступны для взаимодействия.

На виртуальной машине изображение на экране отображается только при активном подключении Пользователя через RDP. Это происходит по следующей причине: пока активна RDP-сессия (Пользователь работает с учётной записью, связанной с Роботом), система функционирует нормально, но при закрытии RDP-сессии (или сворачивания окна с RDP-сессией) интерфейс перестает отображаться, и Робот не может взаимодействовать с его элементами. Существует встроенный механизм обхода этого ограничения, реализованный в Роботе, но он не обеспечивает полной надежности (периодически он перестает работать, и требуется вручную переподключиться к виртуальной машине для восстановления графического сеанса).

Данная проблема не возникает, если сценарий Робота не подразумевает взаимодействия с пользовательским интерфейсом. В этом случае Робот сможет выполнять любые действия без связи с UI, как при отключенной, так и при заблокированной учётной записи.

При использовании комбинации "Unattended-робот + Оркестратор" влияние данной проблемы становится менее заметным. Это происходит благодаря тому, что Оркестратор помогает поддерживать необходимые графические контексты и активные учетные записи. Координатор помогает сохранять активность учётных записей, обеспечивая бесперебойную работу робота. Таким образом, Робот продолжает корректно взаимодействовать с интерфейсом на протяжении всего времени своей работы.

Для сценариев с Attended-роботом можно выделить следующие ситуации:

* Робот, запущенный на физическом компьютере, работает стабильно и без сбоев.
* Робот, запущенный на виртуальной машине с активным подключением по RDP, работает стабильно и без сбоев.
* Робот, запущенный на виртуальной машине без активного RDP-подключения, которому не требуется взаимодействие с UI-элементами, работает стабильно и без сбоев.
* Робот, запущенный на виртуальной машине без активного RDP-подключения (БЕЗ Пользователя, который работает с учётной записью, связанной с Роботом), которому требуется взаимодействие с UI-элементами,  спустя некоторое время прервет свою работу, так как работа с графическим интерфейсом станет невозможной, из-за того что изображение на экране не будет обновляться.

---
hidden: true
---

# Обработка исключений

·         [Подробнее](https://docs.microsoft.com/ru-ru/powershell/scripting/learn/deep-dives/everything-about-exceptions?view=powershell-7.1)

&#x20;

### Вызовы исключений

·         throw "Bad thing happened"

·         Write-Error -Message "Houston, we have a problem." -ErrorAction Stop

&#x20;

### Обработка исключений

&#x20;

try {} catch {} finally {}

&#x20;

·         Принцип обработки исключений в PowerShell (и многих других языках) состоит в том, что сначала к разделу кода применяется try, а если происходит ошибка, к нему применяется catch.

·         Скрипт catch выполняется только в том случае, если произошла неустранимая ошибка. Если try выполняется правильно, catch пропускается. Можно получить доступ к информации об исключении в блоке catch с помощью переменной $\_

·         В блоке catch существует автоматическая переменная ($PSItem или $\_) типа ErrorRecord, содержащая сведения об исключении.

·         Иногда ошибку обрабатывать не требуется, но необходимо выполнить определенный код в зависимости от того, было ли создано исключение. Именно это и делает скрипт finally

`·         Вполне допустимо использовать catch и finally вместе. В большинстве случаев используется либо один, либо другой скрипт, но вам могут встретиться сценарии, в которых используются они оба.`

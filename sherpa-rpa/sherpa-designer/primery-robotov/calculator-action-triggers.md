# Calculator Action Triggers

Рассмотрим пример робота, который одновременно отслеживает разные события в интерфейсе других программ и, в зависимости от произошедшего события, выполняет разные действия: показ сообщения, окна, создание документа, переход на сайт, отправку письма.&#x20;

**Примечание:** _перед запуском проекта необходимо запустить Калькулятор (проверено с Windows 10) и набрать на калькуляторе нужное число, чтобы сработало то или иное событие._

Диаграмма проекта выглядит так (для удобства блоки диаграммы пронумерованы):

<figure><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXf3WQsHGHYugUvPzu308yojZWkCRtRtJjOf_pJKoZR120a6Kd-imlpZk3Rnjhi2AGt4cSQz65iLbwBRB6PiMzu8qVfwSc4911Tj5Q-kv29WfT3UrOW9WPHbR96sXxfeUfJ8ilJgMXiObveND283ix-jABY?key=2Kw34UXGjHk-7PKjgLzXFw" alt=""><figcaption></figcaption></figure>

В данном примере используются коннекторы. Они нужны для того, чтобы диаграмму проекта можно было легко читать.&#x20;

1. **Блок “Старт”** (с этого блока начинается любая диаграмма).
2. **Блок “Параллельный выбор”** позволяет псевдопараллельно выполнить один из непосредственно подключенных к своим выходам блоков, выбрав тот из блоков, в котором не происходит ошибка, и после успешного выполнении такого блока продолжить работу сценария. Подключенный блок считается успешно выполненным, если он не вызвал ошибку (исключение). Для данного блока указано свойство “Время ожидания” (предельное время ожидания выполнения блоков в секундах).

<figure><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXcEVFtvAnigyhArmIkbsRL1-CONtmHTLh8Nz3W6tDHLTWYrL76dUyDsQBdPEYYyY8l18XpEaVHEJgTr7jRByoQIZrnUBxxhoCY2PxXWmJUkLmQvxSGQ7FFYoNBjIjc553ZqHCJhV3ZcZwE0yyZRM7cqmcCT?key=2Kw34UXGjHk-7PKjgLzXFw" alt=""><figcaption></figcaption></figure>

3. **Блок “Контролировать элемент”** проверяет, что элемент с указанным селектором находится в одном из указанных состояний. Для данного блока указаны следующие свойства:

* Селектор (идентификатор элемента пользовательского интерфейса);
* ID процесса (переменная, в которой хранится идентификатор процесса, указывает с каким приложением необходимо работать);
* Состояние (состояние, которое необходимо проверить; в данном случае, проверяется атрибут);
* Тип сравнения (тип сравнения; в данном случае указан тип “Wildcard”);
* Значение сравнения (значение, с которым будет сравниваться полученное значение атрибута, в данном случае: 365);
* Ожидаемый ответ (ожидаемое значение после проверки);
* Атрибут (название атрибута);
* Задержка перед (задержка перед выполнением блока в секундах);
* Задержка после (задержка после выполнения блока в секундах);
* Время ожидания (предельное время ожидания заданного элемента в секундах).

<figure><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXfEysYNoslf0FqSna4dC3iv-eCMuNzSYYtjW_mcufmJrLNuZZPhrXfyANUtz1mCmAmXXeRNWNQ37x3q4dU2STcBvH7tMW3p1iFBKU6zc-N4-NSU54x2R2kfJwJiMSEYA4UzsyvIABJjThnvlhCNyoVI3B4n?key=2Kw34UXGjHk-7PKjgLzXFw" alt=""><figcaption></figcaption></figure>

4. **Блок “Окно с сообщением”** показывает пользователю модальное диалоговое окно, с заданным заголовком, текстом и набором кнопок. Для данного блока указаны следующие свойства:

* Сообщение (переменная, которая будет отображена внутри диалогового окна, в данном случае: “Обнаружено значение 365”);
* Кнопки (кнопки, которые будут доступны пользователю для нажатия).

<figure><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXc1DMbMl9QcMqk_ouadOWWrCLCLD8xkOHkdIgZwlEMST3_D5Z0_5ulYTi8fVzg1_P1etVPtj_vNugtGtWXnhF7qMlhKur-EZca60_PSKxwZk16g-ikTzy80hm1qKAZnXu_05E3Yx8BVOYZ_LJDeB4Gusv66?key=2Kw34UXGjHk-7PKjgLzXFw" alt=""><figcaption></figcaption></figure>

<br>

5. **Блок “Контролировать элемент”** проверяет, что элемент с указанным селектором находится в одном из указанных состояний. Для данного блока указаны следующие свойства:

* Селектор (идентификатор элемента пользовательского интерфейса);
* ID процесса (переменная, в которой хранится идентификатор процесса, указывает с каким приложением необходимо работать);
* Состояние (состояние, которое необходимо проверить; в данном случае, проверяется атрибут);
* Тип сравнения (тип сравнения; в данном случае указан тип “Wildcard”);
* Значение сравнения (значение, с которым будет сравниваться полученное значение атрибута, в данном случае: 893);
* Ожидаемый ответ (ожидаемое значение после проверки);
* Атрибут (название атрибута);
* Задержка перед (задержка перед выполнением блока в секундах);
* Задержка после (задержка после выполнения блока в секундах);
* Время ожидания (предельное время ожидания заданного элемента в секундах).

<figure><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXfnkCN42N20wOJAy9fzlGBuHt8s6gYXUNd_3hyx3w8ok_5KxqkHvKTSx_k28irH8W4FvAS1MFJCnhSEZWV4mKOsOGJ6HtLGKi0CRiGQv-IRLaB_SxlQmdFiNfKJD-wQFT_S-9NAPZtd-E77iKND5B-xEQc?key=2Kw34UXGjHk-7PKjgLzXFw" alt=""><figcaption></figcaption></figure>

6. **Блок “Показать окно”** позволяет создавать свои собственные окна (формы) и отображать их в модальном и немодальном режиме, в том числе, асинхронно по отношению к ходу сценария. Если задан селектор, координаты созданного окна будут привязаны элементу управления в другом приложении.  Для создания и редактирования своего окна воспользуйтесь кнопкой “Редактировать…” блока, а для создания переиспользуемых окон - кнопкой [“Редактор окон”](../rabota-v-sherpa-designer/osnovnoe-menyu/panel-razrabotka/menyu-dopolnitelno/redaktor-okon.md) на главной панели инструментов. Для данного блока указаны следующие свойства:

* Конфигурация (строка конфигурации);
* Объект окна (переменная с объектом окна);
* Селектор (идентификатор элемента, к которому привязано окно при его отображении);
* ID процесса (переменная, в которой хранится идентификатор процесса, указывает с каким приложением необходимо работать);
* Угол привязки (выбор значения угла привязки окна).

Здесь блок “Показать окно” добавлен с помощью инструмента [записи действий пользователя](../rabota-v-sherpa-designer/osnovnoe-menyu/panel-razrabotka/menyu-zapis/zapis-deistvii-polzovatelya/).

<figure><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXfovPINBmNv2WizUw987CcOMxFqTF_w6g5R6vHWF-gnknABs6ZlVmq-U7yEF0I-xqS4jVtJGexbZwOn4ub6Lsour8yZOhEN9NI48phDBUKy9yjDCyOzBQpN9liNfiTb1qbkVla_y0jiUDBJiZL-_-8PxUCv?key=2Kw34UXGjHk-7PKjgLzXFw" alt=""><figcaption></figcaption></figure>

Окно, которую показывает блок создана помощью инструмента “Редактор окон”. Просмотреть его и отредактировать можно, нажав кнопку “Редактировать…”, находящуюся внутри блока.

<figure><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXfgQb11lVq88eTodgCkUg5D4oDKZ8cXokUSPf15sIEo_SAKjAawnDAQlub5dkgGix6wEt5mVoEvyZEA3DiZfwWar7aRYK1RwEFEteOrqUhRBxW2KZTwaRsaKh4eQjfkbUk3erMicKPZHG6lg2VlUc3JOeg3?key=2Kw34UXGjHk-7PKjgLzXFw" alt=""><figcaption></figcaption></figure>

7. **Блок “Получить текст”** позволяет получить видимый текст выбранного элемента пользовательского интерфейса (надписи, текстового поля, пункта меню и т.д.). Для данного блока указаны следующие свойства:

* Селектор (идентификатор элемента пользовательского интерфейса);
* Тип значения (тип извлекаемого значения, в данном случае, это имя);
* ID процесса (переменная, в которой хранится идентификатор процесса, указывает с каким приложением необходимо работать);
* Время ожидания (предельное время ожидания заданного элемента в секундах).
* Автоскроллинг (при установке флага будет автоматически произведена прокрутка списка до элемента, находящегося вне видимой области).

Здесь блок “Получить текст” добавлен с помощью инструмента записи действий пользователя.

<figure><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXc2Ds_2P6CsWXgZsdNvAu0fmGm70oD_qm0cE55eL8rx9L_bZOUugxRffoqAt8dVkr-4BkgZ00Vvy1EVy_Thdf2ipPGWnQxnZJV9S7De1lDt55_mK-5xIM3IZSutqpCLjYlTp8If5bNt3EPkgIo5_QHMNqOH?key=2Kw34UXGjHk-7PKjgLzXFw" alt=""><figcaption></figcaption></figure>

8. **Блок “Преобразовать строку”** позволяет преобразовать строку в заданный формат. Для данного блока указаны следующие свойства:

* Текст (входная строка);
* Тип преобразования (тип преобразования, в  данном случае выбран тип “Int” – оставляет в строке только числа).

<figure><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXejEmpkn7KVjpJsVsdCg5DL4Xsw8_3RtmlkhYGnP8LsqNz3h_1Pl1JogBela5w3tXIGDhE7vFOYHeeowTg_mX6nAVIsl0Jq2NBSLKbp0KoTJsPrOIpaTUuoI-6tvtDx1X7-VcPCaz3n19Vblz6bmH7wI_RV?key=2Kw34UXGjHk-7PKjgLzXFw" alt=""><figcaption></figcaption></figure>

9. **Блок “Условие”** проверяет указанное условие на истинность, после чего выполнение сценария продолжается в сторону выхода “Да” (если условие выполняется) или в сторону выхода “Нет” (если условие не выполнилось).&#x20;

Условие записывается в формате: “переменная” равна (==)/ больше (>)/ меньше (<) “значение”.&#x20;

Например: $a == “Привет”, то есть, если значение переменной $a равно “Привет”, то выход “Да”, в противном случае – выход “Нет”.

$Result > 5, то есть, если значение переменной $Result меньше 5, то выход “Да”, в противном случае – выход “Нет”.

В данном случае используется условие клика по ссылке, в качестве него установлено: $ControlEvent != "". Т. е., если переменная $ControlEvent не пустая, то выход “Да”.

<figure><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXfvkv3qB9wq9LiX5Vlu-dpyfD3WqpTBXJY5rvgdE4NW75WPMZclsJQQq0nQjz8opv7xs7TttCfnPVnMRd_5pn_fDrnKoKldIb1qVhtVvzCNtfMmrcJfO-2tDyc0A7sEl63RKkva9u2hdIkNgdWyK9_Akydu?key=2Kw34UXGjHk-7PKjgLzXFw" alt=""><figcaption></figcaption></figure>

10. **Блок “Контролировать элемент”** проверяет, что элемент с указанным селектором находится в одном из указанных состояний. Для данного блока указаны следующие свойства:

* Селектор (идентификатор элемента пользовательского интерфейса);
* ID процесса (переменная, в которой хранится идентификатор процесса, указывает с каким приложением необходимо работать);
* Состояние (состояние, которое необходимо проверить; в данном случае, проверяется атрибут);
* Тип сравнения (тип сравнения; в данном случае указан тип “Wildcard”);
* Значение сравнения (значение, с которым будет сравниваться полученное значение атрибута, в данном случае: 35);
* Ожидаемый ответ (ожидаемое значение после проверки);
* Атрибут (название атрибута);
* Задержка перед (задержка перед выполнением блока в секундах);
* Задержка после (задержка после выполнения блока в секундах);
* Время ожидания (предельное время ожидания заданного элемента в секундах).

<figure><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXdZR6CpQqCk0UBEKst4HKKswrC8bfzeoPSqstn2ZFY7GuQxa_t69InD0_LCqzkCE3e9N5O0vQ_gSJeZXtALwgRnaddeWoeymX9iQSlD58ire0j_yfNsiShVLzZu6TwaEww_eJzthjGQPv2tzPT1iGFo7gH5?key=2Kw34UXGjHk-7PKjgLzXFw" alt=""><figcaption></figcaption></figure>

11. **Блок “Запустить браузер”** запускает выбранный браузер. Для данного блока указаны следующие свойства:

* Тип браузера (браузер, который необходимо открыть);
* URL (ссылка, которая должна открыться при запуске браузера);
* Время ожидания (время ожидания открытия браузера в секундах).

<figure><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXcYC9rpkV6a8FDhndRZcPfPpjYMQAKROcuQkeTy6Rs17VIFuPrz93LOY-rzLl7tcjDcsky7Wcuyw2POAmsfKkIxt7R7FT_yfiAj_IXXayTh383WMi5RpH4MhlHJ3_rLCKvKzoMPyCKiL1MpZOxZZDrtrS_9?key=2Kw34UXGjHk-7PKjgLzXFw" alt=""><figcaption></figcaption></figure>

12. **Блок “Контролировать элемент”** проверяет, что элемент с указанным селектором находится в одном из указанных состояний. Для данного блока указаны следующие свойства:

* Селектор (идентификатор элемента пользовательского интерфейса);
* ID процесса (переменная, в которой хранится идентификатор процесса, указывает с каким приложением необходимо работать);
* Состояние (состояние, которое необходимо проверить; в данном случае, проверяется атрибут);
* Тип сравнения (тип сравнения; в данном случае указан тип “Wildcard”);
* Значение сравнения (значение, с которым будет сравниваться полученное значение атрибута, в данном случае: 2 000);
* Ожидаемый ответ (ожидаемое значение после проверки);
* Атрибут (название атрибута);
* Задержка перед (задержка перед выполнением блока в секундах);
* Задержка после (задержка после выполнения блока в секундах);
* Время ожидания (предельное время ожидания заданного элемента в секундах).

<figure><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXf5xTVUI8wLB09LpbdcB1RyNb8UlI1_vk0nChIY28stP3a9ftyAYumKvm8AqAX3PrTlEYbJfhdW-NXNiDcg_AXdI-SzlNvqx_EsPlxJq_ztNWT_RyfwRiyJQqdTgu-YBHXFGBGFj6rOuMaH_pgbZbopp23N?key=2Kw34UXGjHk-7PKjgLzXFw" alt=""><figcaption></figcaption></figure>

13. **Блок “Создать документ”** позволяет создать Word-документ. Для данного блока указаны следующие свойства:

* Использовать COM (при установке флага работа будет происходить с помощью установленного Word);
* Видимость (при установке флага в этом свойстве и в свойстве “Использовать COM” интерфейс Word будет отображаться на экране монитора).

<figure><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXdTFMOXNn3aohsUPZtJr4jC62ZejV7jwEq2UYl1ZZZF-RNS1AGBlrmvPEFNiv8JT6_mibq2wUrFAvapQX2eFUgP9ZhMW-lRiCjlcVsVdd2iQNE_lYDWSDv7konqun3wbW8xZavDhOe0A76NYYhMrZBWKUi3?key=2Kw34UXGjHk-7PKjgLzXFw" alt=""><figcaption></figcaption></figure>

14. **Блок “Записать текст в документ”** позволяет записать текст в Word-документ. Для данного блока указаны следующие свойства:

* Ссылка на документ (ссылка на открытый Word-документ, с которым в данный момент происходит работа. Название переменной в данном свойстве должно совпадать с названием переменной в свойстве "Ссылка на документ", блоков "Создать документ" или "Открыть документ" из группы Word, которые ранее использовались для создания или открытия данного документа);
* Текст (текст, который необходимо записать в документ, в данном случае текст выглядит так: “Это тестовый документ, который был создан потому что в Калькулятор было введено число 2 000”).

<figure><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXe7btpfWm1f5P15KY-OG6ItzunPSyNYsphkhM7byQ830w7g6kkLD3r1kZfc1rdvCw0Bh2oecpFZEUOKpkXCBKATWpNX0P30OeQulPZm6plTohYABjEHPhgjkNrHT9GDdZd9A9YMt0uijVNE438SwCA2cB5C?key=2Kw34UXGjHk-7PKjgLzXFw" alt=""><figcaption></figcaption></figure>

15. **Блок “Контролировать элемент”** проверяет, что элемент с указанным селектором находится в одном из указанных состояний. Для данного блока указаны следующие свойства:

* Селектор (идентификатор элемента пользовательского интерфейса);
* ID процесса (переменная, в которой хранится идентификатор процесса, указывает с каким приложением необходимо работать);
* Состояние (состояние, которое необходимо проверить; в данном случае, проверяется атрибут);
* Тип сравнения (тип сравнения; в данном случае указан тип “Wildcard”);
* Значение сравнения (значение, с которым будет сравниваться полученное значение атрибута, в данном случае: 3 000);
* Ожидаемый ответ (ожидаемое значение после проверки);
* Атрибут (название атрибута);
* Задержка перед (задержка перед выполнением блока в секундах);
* Задержка после (задержка после выполнения блока в секундах);
* Время ожидания (предельное время ожидания заданного элемента в секундах).

<figure><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXeoSx9Q1WYvkgiODg3RFUb2y29EaLq70wz48jIFF-9X3plZrfPCJ1q45pMS69Y-EcqWLMaflx-BBRyUpdfVpLh37pvIE0x8Bl57_t9qKy2Mq0gECexNT32u1byfMmK7yjpMyWKuljhNLuUUgZIgn-T_6KOH?key=2Kw34UXGjHk-7PKjgLzXFw" alt=""><figcaption></figcaption></figure>

16. **Блок “Отправить письмо”** позволяет отправить письмо с использованием протокола SMTP. Для данного блока указаны следующие свойства:

* Тема письма (тема письма, в данном случае: “Новое событие в Калькуляторе”);
* Текст письма (текст письма, в данном случае: “Пользователь набрал 3 000”)
* HTML-разметка (при установке флага содержимое письма будет отправлено как HTML-страница и может содержать теги);
* Время ожидания (время ожидания ответа от сервера в секундах).

<figure><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXcyMVJ1jsC5g5mLqqkoYN983zN9JyX3kpD_0NEhQYelKh8MYBtaPNVYjf6TW80ioeM9-8laaxAfO_4oJSbjs-8YiUl0MnTKlJ7bsVx7QMHpLQVDJ3Z6ndfVJBZGgEriR8yoCuz0MB12oSNt2-pUYYHOsAnB?key=2Kw34UXGjHk-7PKjgLzXFw" alt=""><figcaption></figcaption></figure>

17. **Блок “Окно с сообщением”** показывает пользователю модальное диалоговое окно, с заданным заголовком, текстом и набором кнопок. Для данного блока указаны следующие свойства:

* Сообщение (переменная, которая будет отображена внутри диалогового окна, в данном случае: “Письмо отправлено”);
* Кнопки (кнопки, которые будут доступны пользователю для нажатия).

<figure><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXcoWiWykzd3lj2lHC7tNCaz8V16CNe8TGomc-mZ6dC22IA5njTj7KeR8gPtmGVnddyKL0RPmjzsa158iUfse0A6tq-nxkJB20EOmulcx9mXSfET28LOV2QtLEuuYdMl6b-C3Y3_Fpum4d6CeIOIvZJ1Rqo?key=2Kw34UXGjHk-7PKjgLzXFw" alt=""><figcaption></figcaption></figure>

18. **Блок “Клик мышкой”** эмулирует клик мышкой по кнопке сброса. Данный блок добавлен с помощью инструмента записи действий пользователя.

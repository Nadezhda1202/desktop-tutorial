# Редактор выражений

**Выражения** – важный и мощный инструмент, позволяющий не использовать дополнительные лишние блоки, а прямо в том месте, где возникла такая потребность, производить разные арифметические вычисления, выполнять операции со строками и использовать встроенные функции (и всё это внутри свойства).

## **Редактировать выражения**

Для удобства работы с выражениями используйте окно "Редактировать выражения". Окно вызывается из Панели свойств блока нажатием на многоточие рядом с любым свойством, которое поддерживает использование выражений.

<figure><img src="../../../../../../.gitbook/assets/РедактВыржн.png" alt=""><figcaption></figcaption></figure>

Окно "Редактировать выражение" предназначено для формирования выражений, которые могут быть использованы в качестве условий для проверки, формул для вычисления значений и т.д.  Редактор позволяет создавать и редактировать ранее созданные выражения без привлечения разработчиков системы, силами подготовленного пользователя или администратора. В нижней части данного окна есть справка по функциям. Выберите категорию функций и саму функцию, чтобы увидеть подсказку по ее использованию в выражении. Дважды кликните на функции или примере использования выражения чтобы вставить его в текущее редактируемое выражение.

При клике на данную кнопку открывается окно "Редактировать выражение". Здесь можно задать константу, соответствующую тому типу данных, который ожидает свойство.

<figure><img src="../../../../../../.gitbook/assets/image (71).png" alt=""><figcaption></figcaption></figure>

Также в Редакторе выражений есть возможность указать путь к папке или файлу в поле редактирования выражения. Для этого нужно кликнуть правой кнопкой мыши на поле редактирования выражения и выбрать один из пунктов во всплывающем меню:

* “Выбрать путь к папке…”;
* “Выбрать путь к файлу…”.

Путь будет вставлен в окно в текущую позицию курсора.

<figure><img src="https://docs.sherparpa.ru/~gitbook/image?url=https%3A%2F%2F483167589-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FpyvTUnAaOD3OMZ1w2jM6%252Fuploads%252FwtdbZIa4fRXvFCp7K1cA%252F%25D0%25B8%25D0%25B7%25D0%25BE%25D0%25B1%25D1%2580%25D0%25B0%25D0%25B6%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5.png%3Falt%3Dmedia%26token%3D9cdf345d-4bd2-4202-9b41-aede1bad27f7&#x26;width=768&#x26;dpr=4&#x26;quality=100&#x26;sign=135cffe5&#x26;sv=2" alt=""><figcaption></figcaption></figure>

## **Структура выражений**

Выражения в системе используются для наложения различных условий на данные при поиске данных, отборе данных для отчетов, проверке правильности ввода данных и т.д.  Выражения могут быть записаны в виде математических функций, даты и произвольных выражений (написанных на языке выражений, который похож на язык PowerShell).  В выражениях могут быть использованы константы, переменные, математические функции или методы.

Когда вы используете выражение в свойстве Блока, то в момент, когда выполнение сценария дошло до этого Блока, вычисляются значения выражений, при этом берутся текущие значений всех используемых в выражении переменных. Результат вычисления выражения используется как значение свойства, в котором это выражение было записано.

Свойства, которые размещены в разделе Output, не допускают использования выражений. В них необходимо записать имя переменной, в которую Блок должен поместить результат своей работы.

Блок Выполнить выражение (InvokeExpression) в свойствах Выражения (Expression) позволяет использовать выражения расширенного формата, которые похожи на выражения на скриптовом языке PowerShell. В них в том числе можно использовать явные присвоения. Выражение записывается $Имяпеременной, затем следует знак равенства (=), а за ним значение, которое вы хотите присвоить. Для указания переменной используйте ключевой символ $. Для присваивания значений переменным использоваться оператор присваивания «=».

## Видео

Работа с подсказками IntelliSense в Редакторе выражений продемонстрирована здесь:

{% embed url="https://sherparpa.ru/ucontent/?g8ES" %}

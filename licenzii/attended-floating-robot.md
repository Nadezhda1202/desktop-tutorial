# Attended Floating робот

## 1.       Процедура активации

Лицензия может быть активирована как локально, так и через Sherpa Orchestrator. В случае локальной активации лицензионный ключ сохраняется на конкретном рабочем месте, а для активации через Orchestrator — в централизованной системе.

### 1.1. Локальная активация

Запустите Sherpa Assistant, если он не был запущен. Правой кнопкой мыши кликните на иконку Sherpa Assistant в трее: ![](<../.gitbook/assets/изображение (11).png>).

В контекстном меню выберите “Настройки…”:

<figure><img src="../.gitbook/assets/изображение (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

В открывшемся окне нажмите на вкладку “Регистрация”. Введите ключ продукта, который получили в поле “Введите лицензионный ключ продукта”:

<figure><img src="../.gitbook/assets/изображение (2) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

Нажмите на кнопку Активация. Sherpa Assistant проверит ключ продукта и предоставит дату и время, до которого действует Лицензия зеленым шрифтом под полем “Введите лицензионный ключ продукта”.

### 1.2. Активация через Sherpa Orchestrator

Экран “Лицензии” содержит таблицу “Лицензии”:

<figure><img src="../.gitbook/assets/изображение (3) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

Для активации созданной Лицензии необходимо нажать кнопку “Активировать“ и в открывшемся окне выбрать один из двух типов активации:

<figure><img src="../.gitbook/assets/изображение (4) (1) (1).png" alt=""><figcaption></figcaption></figure>

#### 1.2.1.       Автоматическая

При выборе автоматической активации нажать на кнопку ОК.

<table data-header-hidden><thead><tr><th width="85.7166748046875" valign="top"></th><th width="625.0665283203125"></th></tr></thead><tbody><tr><td valign="top"><div><figure><img src="../.gitbook/assets/изображение (5) (1).png" alt="" width="43"><figcaption></figcaption></figure></div></td><td>Автоматическая активация возможна только в том случае, если Оркестратор имеет открытый доступ в Интернет.</td></tr></tbody></table>

#### 1.2.2.       Ручная

При выборе ручной активации появляется код запроса, который нужно передать вендору для подтверждения ручной активации. В ответ на код запроса вам будет передан код ответа, его необходимо ввести в поле Код ответа и нажать на кнопку ОК:

<figure><img src="../.gitbook/assets/изображение (6) (1).png" alt=""><figcaption></figcaption></figure>

Лицензия будет активирована, и в колонке “Истекает” изменится дата и время истечения Лицензии.

## 2.       Переактивация

Перенос осуществляется через Sherpa Orchestrator.

Если вам нужно передать Лицензию другому пользователю, выполните отвязку от Оркестратора. Для этого в интерфейсе Оркестратора уберите активную Floating Лицензию и назначьте ее новому Роботу.

Оба робота должны быть добавлены в таблицу “Роботы” на экране “Роботы“.

<figure><img src="../.gitbook/assets/изображение (7) (1).png" alt=""><figcaption></figcaption></figure>

Справа от строки с именем робота, которого нужно отвязать от Оркестратора, нажмите на иконку <img src="../.gitbook/assets/изображение (8) (1).png" alt="" data-size="line"> и измените поле “Лицензия“. Далее сохраните изменения нажатие кнопки “ОК“ и создайте нового робота через кнопку “Создать“.

Процесс создания нового робота подробно описан по ссылке: [https://docs.sherparpa.ru/sherpa-orchestrator/rabota-v-sherpa-orchestrator/ekrany/roboty#sozdanie-novogo-robota](https://docs.sherparpa.ru/sherpa-orchestrator/rabota-v-sherpa-orchestrator/ekrany/roboty#sozdanie-novogo-robota)

## 3.       Управление

Attended Floating разрешает запускать роботов на виртуальных машинах без постоянного RDP-подключения и используется для автоматизированных процессов, где участие пользователя минимально.

Необходимо перейти на экран “Работы”. Данный экран содержит таблицу “Работы”:

<figure><img src="../.gitbook/assets/изображение (9) (1).png" alt=""><figcaption></figcaption></figure>

Нажмите на кнопку “Создать” над таблицей "Работы" и заполните открывшуюся форму:

<figure><img src="../.gitbook/assets/изображение (10) (1).png" alt=""><figcaption></figcaption></figure>

·         поле “Робот”. Выберите из выпадающего списка нужного робота;

·         поле “Процесс”. Выберите из выпадающего списка нужный процесс;

·         поле “Задача”. Это опциональный параметр, данное поле можно оставить незаполненным, или заполнить созданной ранее задачей;

·         поле “Остановить после”. Укажите дату и время, после которых необходимо остановить выполнение работы;

·         поле “Прервать после”. Укажите дату и время, после которых необходимо прервать выполнение работы.

После заполнения полей нажмите кнопку “ОК”, чтобы сохранить работу.

Для новой работы после сохранения по умолчанию будет указан статус “В ожидании”. Как только освободится робот, для которого была назначена данная работа, он приступит к ее выполнению, запустит сценарий соответствующего процесса, выполнит его и, в зависимости от результата работы, может меняться статус работы в колонке “Статус”:

<figure><img src="../.gitbook/assets/изображение (11) (1).png" alt=""><figcaption></figcaption></figure>

### 3.1. Запуск робота вручную пользователем двойным кликом по файлу робота

Откройте директорию, где сохранён файл с расширением .robot и дважды кликните по нему левой кнопкой мыши.

<figure><img src="../.gitbook/assets/изображение (12).png" alt=""><figcaption></figcaption></figure>

### 3.2. Запуск выбором из списка доступных роботов в Sherpa Assistant

\
Найдите в трее иконку ассистента ![](<../.gitbook/assets/изображение (13).png>) и нажмите на неё правой кнопкой мыши. Во всплывающем меню выберите строку “Роботы“:

<figure><img src="../.gitbook/assets/изображение (14).png" alt=""><figcaption></figcaption></figure>

Для запуска программного робота нажмите на кнопку <img src="../.gitbook/assets/изображение (15).png" alt="" data-size="line"> в строке робота, которого необходимо запустить:

<figure><img src="../.gitbook/assets/изображение (16).png" alt=""><figcaption></figcaption></figure>

Подтвердите запуск в диалоговом окне нажатием на кнопку “Да“:

<figure><img src="../.gitbook/assets/изображение (17).png" alt=""><figcaption></figcaption></figure>

Если в свойствах запускаемого робота указаны входные параметры, то откроется окно с полями для ввода значений.

### 3.3. Запуск по горячей клавише

\
Найдите в трее иконку ассистента ![](<../.gitbook/assets/изображение (18).png>) и нажмите на неё правой кнопкой мыши. Во всплывающем меню выберите строку “Роботы“:

<figure><img src="../.gitbook/assets/изображение (19).png" alt=""><figcaption></figcaption></figure>

Выберите в списке нужного робота и введите в нижней части окна нужную последовательность в поле “Горячие клавиши“:

<figure><img src="../.gitbook/assets/изображение (20).png" alt=""><figcaption></figcaption></figure>

Нажмите на кнопку “Задать клавиши“. Теперь данная последовательность закреплена за роботом и при нажатии данных клавиш на клавиатуре робот будет запускаться.

<figure><img src="../.gitbook/assets/изображение (21).png" alt=""><figcaption></figcaption></figure>

### 3.4. Запуск из командной строки

Чтобы запустить командную строку в Windows, нажмите одновременно клавиши “Win“ и “R“, введите: “cmd“, и нажмите “Enter“. Откроется окно командной строки. Введите команду “cd“, которая используется для изменения текущего рабочего каталога, а также название каталога (например, “cd&#x20;

Desktop“, если робот находится на рабочем столе, или абсолютный путь: “cd /home/user/projects“, чтобы перейти в нужную папку, где находится робот).

<figure><img src="../.gitbook/assets/изображение (22).png" alt=""><figcaption></figcaption></figure>

_Примечание:_ Также командную строку можно запустить через строку поиска Windows. Для этого нажмите одновременно клавиши “Win“ и “S“, введите: “командная строка“, и нажмите “Enter“.

Далее введите команду “cd“ и наименование робота с расширением “.robot“ и нажмите “Enter“.

<figure><img src="../.gitbook/assets/изображение (23).png" alt=""><figcaption></figcaption></figure>

Робот запустится в отдельном окне.

### 3.5. Запуск из локального Планировщика Windows

Откройте диаграмму проекта в Sherpa Designer:

<figure><img src="../.gitbook/assets/изображение (24).png" alt=""><figcaption></figcaption></figure>

Опубликуйте проект (робота) на Рабочий стол:

<figure><img src="../.gitbook/assets/изображение (25).png" alt=""><figcaption></figcaption></figure>

Найдите “Средства администрирования Windows” через строку поиска Windows:

<figure><img src="../.gitbook/assets/изображение (26).png" alt=""><figcaption></figcaption></figure>

Откройте “Средства администрирования Windows” двойным кликом левой кнопкой мыши. Войдите в “Планировщик задач”:

<figure><img src="../.gitbook/assets/изображение (27).png" alt=""><figcaption></figcaption></figure>

Откроется следующее всплывающее окно:

<figure><img src="../.gitbook/assets/изображение (28).png" alt=""><figcaption></figcaption></figure>

Войдите в “Библиотеку планировщика Windows“. Для этого кликните правой кнопкой мыши на свободную часть в окне с файлами, состояниями и триггерами. Выберите строку “Создать простую задачу”:

<figure><img src="../.gitbook/assets/изображение (29).png" alt=""><figcaption></figcaption></figure>

Откроется окно “Мастер создания простой задачи”. Последовательно заполняйте поля во вкладках “Создание простой задачи”, “Триггер” и “Действие”, нажимая на кнопку “Далее”. В появившейся вкладке “Запуск программы” нажмите на кнопку “Обзор…”:

<figure><img src="../.gitbook/assets/изображение (30).png" alt=""><figcaption></figcaption></figure>

Найдите проект (робота), сохраненный на Рабочем столе, кликните на него левой кнопкой мыши и нажмите на кнопку “Открыть”.

Нажмите на кнопку “Далее”, проверьте описание задачи и затем нажмите на кнопку “Готово”.

<figure><img src="../.gitbook/assets/изображение (31).png" alt=""><figcaption></figcaption></figure>

В “Планировщике задач Windows“ появится строка с созданной задачей. Кликните правой кнопкой мыши на нужную строку и выберите во всплывающем меню строку “Выполнить”:

<figure><img src="../.gitbook/assets/изображение (32).png" alt=""><figcaption></figcaption></figure>

Во всплывающем окне “Каким образом вы хотите открыть этот файл?” нажмите на “Sherpa RPA Robot” и подтвердите свой выбор нажатием на кнопку “ОК”:

<figure><img src="../.gitbook/assets/изображение (33).png" alt=""><figcaption></figcaption></figure>

Настройка запуска робота через “Планировщик Windows“ завершена. Если требуется внести изменения настройки запуска, то необходимо во всплывающем меню перейти в раздел Свойства:

<figure><img src="../.gitbook/assets/изображение (34).png" alt=""><figcaption></figcaption></figure>

Например, чтобы изменить триггеры в задаче, можно открыть вкладку “Триггеры“ и нажать на кнопку “Изменить…”:

<figure><img src="../.gitbook/assets/изображение (35).png" alt=""><figcaption></figcaption></figure>

### 3.6. Запуск из Планировщика Windows по локальному расписанию

Для того, чтобы робот запускался автоматически по локальному расписанию и при его запуске не появлялось окно “Каким образом вы хотите открыть этот файл?”, необходимо перейти к расположению файла Sherpa Assistant:

<figure><img src="../.gitbook/assets/изображение (36).png" alt=""><figcaption></figcaption></figure>

Далее найти приложение “ProcessAgent.exe“:

<figure><img src="../.gitbook/assets/изображение (37).png" alt=""><figcaption></figcaption></figure>

И скопировать путь к данному приложению.

Перейти в “Планировщике задач“ в раздел “Свойства“:

<figure><img src="../.gitbook/assets/изображение (38).png" alt=""><figcaption></figcaption></figure>

Открыть вкладку “Действия“ и нажать на кнопку “Изменить…”:

<figure><img src="../.gitbook/assets/изображение (39).png" alt=""><figcaption></figcaption></figure>

Появится всплывающее окно “Изменение действия“:

<figure><img src="../.gitbook/assets/изображение (40).png" alt=""><figcaption></figcaption></figure>

В поле “Программа или сценарий“ вставьте скопированный ранее путь к приложению “ProcessAgent.exe“, а в поле “Добавить аргументы (необязательно)“ полный путь к запускаемому роботу в кавычках:

<figure><img src="../.gitbook/assets/изображение (41).png" alt=""><figcaption></figcaption></figure>

В конце нажмите на кнопку “ОК“. Теперь робот будет запускаться по локальному расписанию через “Планировщик Windows“. Если потребуется изменить расписание, то будет необходимо открыть вкладку “Триггеры“, нажать на кнопку “Изменить…” и внести изменения в расписание:

<figure><img src="../.gitbook/assets/изображение (42).png" alt=""><figcaption></figcaption></figure>
